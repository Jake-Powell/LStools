<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="LStools">
<title>Creating Sankey Diagrams • LStools</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.11/clipboard.min.js" integrity="sha512-7O5pXpc0oCRrxk8RUfDYFgn0nO1t+jLuIOQdOMRp4APB7uZ4vSjspzp5y6YDtDs4VzUSTbWzBFZ/LKJhnyFOKw==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Creating Sankey Diagrams">
<meta property="og:description" content="LStools">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light" data-bs-theme="light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">LStools</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/Creating_simple_reports.html">Creating simple reports</a>
    <a class="dropdown-item" href="../articles/Creating-Sankey-Diagrams.html">Creating Sankey Diagrams</a>
  </div>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav"></ul>
</div>

    
  </div>
</nav><div class="container template-article">



<link href="Creating-Sankey-Diagrams_files/htmltools-fill-0.5.8.1/fill.css" rel="stylesheet">
<script src="Creating-Sankey-Diagrams_files/htmlwidgets-1.6.4/htmlwidgets.js"></script><link href="Creating-Sankey-Diagrams_files/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet">
<script src="Creating-Sankey-Diagrams_files/datatables-binding-0.33/datatables.js"></script><link href="Creating-Sankey-Diagrams_files/dt-core-1.13.6/css/jquery.dataTables.min.css" rel="stylesheet">
<link href="Creating-Sankey-Diagrams_files/dt-core-1.13.6/css/jquery.dataTables.extra.css" rel="stylesheet">
<script src="Creating-Sankey-Diagrams_files/dt-core-1.13.6/js/jquery.dataTables.min.js"></script><link href="Creating-Sankey-Diagrams_files/crosstalk-1.2.1/css/crosstalk.min.css" rel="stylesheet">
<script src="Creating-Sankey-Diagrams_files/crosstalk-1.2.1/js/crosstalk.min.js"></script><script src="Creating-Sankey-Diagrams_files/d3-4.5.0/d3.min.js"></script><script src="Creating-Sankey-Diagrams_files/sankey-1/sankey.js"></script><script src="Creating-Sankey-Diagrams_files/sankeyNetwork-binding-0.4/sankeyNetwork.js"></script><div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Creating Sankey Diagrams</h1>
            
      
      
      <div class="d-none name"><code>Creating-Sankey-Diagrams.Rmd</code></div>
    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://jakepowellcubg.github.io/LStools/">LStools</a></span><span class="op">)</span></span></code></pre></div>
<p><em>In this vignette we show how to use the LStools package to create
sankey diagrams of the educational pipeline</em></p>
<p>Firstly we need to create some data.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">33</span><span class="op">)</span></span>
<span><span class="va">KS1</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'3+'</span>,<span class="st">'2A'</span>,<span class="st">'2B'</span>, <span class="st">'2C-'</span><span class="op">)</span>, <span class="fl">10000</span>, replace <span class="op">=</span> <span class="cn">T</span>, prob <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">.21</span>,<span class="fl">.28</span>,<span class="fl">.26</span>,<span class="fl">.25</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">KS2</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'6'</span>,<span class="st">'5+'</span>, <span class="st">'5-'</span>,<span class="st">'4'</span>,<span class="st">'3-'</span><span class="op">)</span>, <span class="fl">10000</span>, replace <span class="op">=</span> <span class="cn">T</span>, prob <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.03</span>, <span class="fl">0.15</span>, <span class="fl">0.22</span>, <span class="fl">0.46</span>, <span class="fl">0.13</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">GCSE</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'9'</span>,<span class="st">'8'</span>, <span class="st">'7'</span>, <span class="st">'6-'</span><span class="op">)</span>, <span class="fl">10000</span>, replace <span class="op">=</span> <span class="cn">T</span>, prob <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.03</span>, <span class="fl">0.07</span>, <span class="fl">0.10</span>, <span class="fl">0.80</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">A_level</span> <span class="op">=</span>  <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'Maths + Further'</span>,  <span class="st">'Maths'</span>, <span class="st">'No Maths'</span><span class="op">)</span>, <span class="fl">10000</span>, replace <span class="op">=</span> <span class="cn">T</span>, prob <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.02</span>, <span class="fl">0.09</span>, <span class="fl">0.89</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">FSM</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'Yes'</span>, <span class="st">'No'</span><span class="op">)</span>, <span class="fl">10000</span>, replace <span class="op">=</span> <span class="cn">T</span>, prob <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">.238</span>, <span class="fl">1</span><span class="op">-</span><span class="fl">.238</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">raw</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>FSM <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">FSM</span><span class="op">)</span>,</span>
<span>                 KS1 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">KS1</span>, levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'3+'</span>,<span class="st">'2A'</span>,<span class="st">'2B'</span>, <span class="st">'2C-'</span><span class="op">)</span><span class="op">)</span>,</span>
<span>                 KS2 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">KS2</span>, levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'6'</span>,<span class="st">'5+'</span>, <span class="st">'5-'</span>,<span class="st">'4'</span>,<span class="st">'3-'</span><span class="op">)</span><span class="op">)</span>,</span>
<span>                 GCSE<span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">GCSE</span>, levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'9'</span>,<span class="st">'8'</span>, <span class="st">'7'</span>, <span class="st">'6-'</span><span class="op">)</span><span class="op">)</span>, </span>
<span>                 A_level <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">A_level</span>, levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'Maths + Further'</span>,  <span class="st">'Maths'</span>, <span class="st">'No Maths'</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>Within the data each row contains information about an individual
student, in our case whether they are classed as receiving free school
meals (FSM), and their maths grades at KS1 (5 years old), KS2 (11 years
old), GCSE (16 years old) and whether they do maths at A-levels (18
years old). The students grades are grouped at the various levels
mirroring the proportion of students taken from the maths pipeline
report (figure XX). Note that the columns must be cast by factor with
the order in which you want the ‘nodes’ to appear (i.e in our case
highest level to lowest level).</p>
<p>We show the first 10 rows of the data below</p>
<p></p>
<div class="datatables html-widget html-fill-item" id="htmlwidget-ac96cb3ee4656e2e9ec3" style="width:100%;height:auto;"></div> <script type="application/json" data-for="htmlwidget-ac96cb3ee4656e2e9ec3">{"x":{"filter":"none","vertical":false,"data":[["No","No","No","No","No","No","No","No","No","No"],["2B","2B","2B","3+","3+","2B","2B","2B","2A","2A"],["5-","5-","4","5-","3-","3-","4","4","5+","5+"],["6-","7","6-","6-","6-","6-","6-","6-","6-","6-"],["No Maths","No Maths","No Maths","No Maths","No Maths","No Maths","No Maths","No Maths","No Maths","No Maths"]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th>FSM<\/th>\n      <th>KS1<\/th>\n      <th>KS2<\/th>\n      <th>GCSE<\/th>\n      <th>A_level<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"scrollX":true,"dom":"tp","paging":false,"columnDefs":[{"name":"FSM","targets":0},{"name":"KS1","targets":1},{"name":"KS2","targets":2},{"name":"GCSE","targets":3},{"name":"A_level","targets":4}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script><p>We want to be able to visualise the data via a sankey diagram from
KS1 to A-levels. The first step is to convert the individual student
data (contained in <code>raw</code>) to ‘pathways’, using the function
<code><a href="../reference/raw_to_pathway.html">raw_to_pathway()</a></code> which details the number of students who
have unique demographics and paths through the pipeline.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">pathways</span> <span class="op">=</span> <span class="fu">LStools</span><span class="fu">::</span><span class="fu"><a href="../reference/raw_to_pathway.html">raw_to_pathway</a></span><span class="op">(</span><span class="va">raw</span><span class="op">)</span></span></code></pre></div>
<p>The first 10 rows of pathways are shown below</p>
<p></p>
<div class="datatables html-widget html-fill-item" id="htmlwidget-e5c8c404fe174e4c81bd" style="width:100%;height:auto;"></div> <script type="application/json" data-for="htmlwidget-e5c8c404fe174e4c81bd">{"x":{"filter":"none","vertical":false,"data":[["No","No","No","No","No","No","No","No","No","No"],["3+","3+","3+","3+","3+","3+","3+","3+","3+","3+"],["6","6","6","6","6","5+","5+","5+","5+","5+"],["8","7","6-","6-","6-","9","8","8","8","7"],["No Maths","No Maths","Maths + Further","Maths","No Maths","No Maths","Maths + Further","Maths","No Maths","Maths + Further"],[4,6,2,1,32,3,1,1,9,2]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th>FSM<\/th>\n      <th>KS1<\/th>\n      <th>KS2<\/th>\n      <th>GCSE<\/th>\n      <th>A_level<\/th>\n      <th>No_students<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"scrollX":true,"dom":"tp","paging":false,"columnDefs":[{"className":"dt-right","targets":5},{"name":"FSM","targets":0},{"name":"KS1","targets":1},{"name":"KS2","targets":2},{"name":"GCSE","targets":3},{"name":"A_level","targets":4},{"name":"No_students","targets":5}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script><div class="section level3">
<h3 id="creating-sankey-diagrams-directly-using-pathways">Creating sankey diagrams directly using pathways<a class="anchor" aria-label="anchor" href="#creating-sankey-diagrams-directly-using-pathways"></a>
</h3>
<p>We can then use <code><a href="../reference/sankey_filtered.html">sankey_filtered()</a></code> to convert the
pathways data frame into a sankey diagram.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">p</span> <span class="op">=</span> <span class="fu"><a href="../reference/sankey_filtered.html">sankey_filtered</a></span><span class="op">(</span>pathways <span class="op">=</span> <span class="va">pathways</span>, flow_columns <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span><span class="op">:</span><span class="fl">5</span><span class="op">)</span>, filters <span class="op">=</span> <span class="st">''</span><span class="op">)</span></span>
<span></span>
<span><span class="va">p</span></span></code></pre></div>
<div class="sankeyNetwork html-widget html-fill-item" id="htmlwidget-36aa3d2a04d42bbc2145" style="width:960px;height:384px;"></div>
<script type="application/json" data-for="htmlwidget-36aa3d2a04d42bbc2145">{"x":{"links":{"source":[0,1,2,3,0,1,2,3,0,1,2,3,0,1,2,3,0,1,2,3,4,5,6,7,8,4,5,6,7,8,4,5,6,7,8,4,5,6,7,8,9,10,11,12,9,10,11,12,9,10,11,12],"target":[4,4,4,4,5,5,5,5,6,6,6,6,7,7,7,7,8,8,8,8,9,9,9,9,9,10,10,10,10,10,11,11,11,11,11,12,12,12,12,12,13,13,13,13,14,14,14,14,15,15,15,15],"value":["58","83","74","74","317","415","409","353","460","608","661","561","992","1242","1241","1175","264","362","339","312","7","31","64","149","34","20","103","170","362","93","29","175","228","447","139","233","1185","1828","3692","1011","7","18","14","168","25","64","95","661","253","666","909","7120"],"name":["Flow: (KS1: 3+) -> (KS2: 6) = 58\n\n As percent of students leaving KS1: 3+ = 2.8%.\n\n As percent of students entering KS2: 6 = 20.1%.","Flow: (KS1: 2A) -> (KS2: 6) = 83\n\n As percent of students leaving KS1: 2A = 3.1%.\n\n As percent of students entering KS2: 6 = 28.7%.","Flow: (KS1: 2B) -> (KS2: 6) = 74\n\n As percent of students leaving KS1: 2B = 2.7%.\n\n As percent of students entering KS2: 6 = 25.6%.","Flow: (KS1: 2C-) -> (KS2: 6) = 74\n\n As percent of students leaving KS1: 2C- = 3%.\n\n As percent of students entering KS2: 6 = 25.6%.","Flow: (KS1: 3+) -> (KS2: 5+) = 317\n\n As percent of students leaving KS1: 3+ = 15.2%.\n\n As percent of students entering KS2: 5+ = 21.2%.","Flow: (KS1: 2A) -> (KS2: 5+) = 415\n\n As percent of students leaving KS1: 2A = 15.3%.\n\n As percent of students entering KS2: 5+ = 27.8%.","Flow: (KS1: 2B) -> (KS2: 5+) = 409\n\n As percent of students leaving KS1: 2B = 15%.\n\n As percent of students entering KS2: 5+ = 27.4%.","Flow: (KS1: 2C-) -> (KS2: 5+) = 353\n\n As percent of students leaving KS1: 2C- = 14.3%.\n\n As percent of students entering KS2: 5+ = 23.6%.","Flow: (KS1: 3+) -> (KS2: 5-) = 460\n\n As percent of students leaving KS1: 3+ = 22%.\n\n As percent of students entering KS2: 5- = 20.1%.","Flow: (KS1: 2A) -> (KS2: 5-) = 608\n\n As percent of students leaving KS1: 2A = 22.4%.\n\n As percent of students entering KS2: 5- = 26.6%.","Flow: (KS1: 2B) -> (KS2: 5-) = 661\n\n As percent of students leaving KS1: 2B = 24.3%.\n\n As percent of students entering KS2: 5- = 28.9%.","Flow: (KS1: 2C-) -> (KS2: 5-) = 561\n\n As percent of students leaving KS1: 2C- = 22.7%.\n\n As percent of students entering KS2: 5- = 24.5%.","Flow: (KS1: 3+) -> (KS2: 4) = 992\n\n As percent of students leaving KS1: 3+ = 47.4%.\n\n As percent of students entering KS2: 4 = 21.3%.","Flow: (KS1: 2A) -> (KS2: 4) = 1242\n\n As percent of students leaving KS1: 2A = 45.8%.\n\n As percent of students entering KS2: 4 = 26.7%.","Flow: (KS1: 2B) -> (KS2: 4) = 1241\n\n As percent of students leaving KS1: 2B = 45.6%.\n\n As percent of students entering KS2: 4 = 26.7%.","Flow: (KS1: 2C-) -> (KS2: 4) = 1175\n\n As percent of students leaving KS1: 2C- = 47.5%.\n\n As percent of students entering KS2: 4 = 25.3%.","Flow: (KS1: 3+) -> (KS2: 3-) = 264\n\n As percent of students leaving KS1: 3+ = 12.6%.\n\n As percent of students entering KS2: 3- = 20.7%.","Flow: (KS1: 2A) -> (KS2: 3-) = 362\n\n As percent of students leaving KS1: 2A = 13.4%.\n\n As percent of students entering KS2: 3- = 28.3%.","Flow: (KS1: 2B) -> (KS2: 3-) = 339\n\n As percent of students leaving KS1: 2B = 12.4%.\n\n As percent of students entering KS2: 3- = 26.5%.","Flow: (KS1: 2C-) -> (KS2: 3-) = 312\n\n As percent of students leaving KS1: 2C- = 12.6%.\n\n As percent of students entering KS2: 3- = 24.4%.","Flow: (KS2: 6) -> (GCSE: 9) = 7\n\n As percent of students leaving KS2: 6 = 2.4%.\n\n As percent of students entering GCSE: 9 = 2.5%.","Flow: (KS2: 5+) -> (GCSE: 9) = 31\n\n As percent of students leaving KS2: 5+ = 2.1%.\n\n As percent of students entering GCSE: 9 = 10.9%.","Flow: (KS2: 5-) -> (GCSE: 9) = 64\n\n As percent of students leaving KS2: 5- = 2.8%.\n\n As percent of students entering GCSE: 9 = 22.5%.","Flow: (KS2: 4) -> (GCSE: 9) = 149\n\n As percent of students leaving KS2: 4 = 3.2%.\n\n As percent of students entering GCSE: 9 = 52.3%.","Flow: (KS2: 3-) -> (GCSE: 9) = 34\n\n As percent of students leaving KS2: 3- = 2.7%.\n\n As percent of students entering GCSE: 9 = 11.9%.","Flow: (KS2: 6) -> (GCSE: 8) = 20\n\n As percent of students leaving KS2: 6 = 6.9%.\n\n As percent of students entering GCSE: 8 = 2.7%.","Flow: (KS2: 5+) -> (GCSE: 8) = 103\n\n As percent of students leaving KS2: 5+ = 6.9%.\n\n As percent of students entering GCSE: 8 = 13.8%.","Flow: (KS2: 5-) -> (GCSE: 8) = 170\n\n As percent of students leaving KS2: 5- = 7.4%.\n\n As percent of students entering GCSE: 8 = 22.7%.","Flow: (KS2: 4) -> (GCSE: 8) = 362\n\n As percent of students leaving KS2: 4 = 7.8%.\n\n As percent of students entering GCSE: 8 = 48.4%.","Flow: (KS2: 3-) -> (GCSE: 8) = 93\n\n As percent of students leaving KS2: 3- = 7.3%.\n\n As percent of students entering GCSE: 8 = 12.4%.","Flow: (KS2: 6) -> (GCSE: 7) = 29\n\n As percent of students leaving KS2: 6 = 10%.\n\n As percent of students entering GCSE: 7 = 2.8%.","Flow: (KS2: 5+) -> (GCSE: 7) = 175\n\n As percent of students leaving KS2: 5+ = 11.7%.\n\n As percent of students entering GCSE: 7 = 17.2%.","Flow: (KS2: 5-) -> (GCSE: 7) = 228\n\n As percent of students leaving KS2: 5- = 10%.\n\n As percent of students entering GCSE: 7 = 22.4%.","Flow: (KS2: 4) -> (GCSE: 7) = 447\n\n As percent of students leaving KS2: 4 = 9.6%.\n\n As percent of students entering GCSE: 7 = 43.9%.","Flow: (KS2: 3-) -> (GCSE: 7) = 139\n\n As percent of students leaving KS2: 3- = 10.9%.\n\n As percent of students entering GCSE: 7 = 13.7%.","Flow: (KS2: 6) -> (GCSE: 6-) = 233\n\n As percent of students leaving KS2: 6 = 80.6%.\n\n As percent of students entering GCSE: 6- = 2.9%.","Flow: (KS2: 5+) -> (GCSE: 6-) = 1185\n\n As percent of students leaving KS2: 5+ = 79.3%.\n\n As percent of students entering GCSE: 6- = 14.9%.","Flow: (KS2: 5-) -> (GCSE: 6-) = 1828\n\n As percent of students leaving KS2: 5- = 79.8%.\n\n As percent of students entering GCSE: 6- = 23%.","Flow: (KS2: 4) -> (GCSE: 6-) = 3692\n\n As percent of students leaving KS2: 4 = 79.4%.\n\n As percent of students entering GCSE: 6- = 46.4%.","Flow: (KS2: 3-) -> (GCSE: 6-) = 1011\n\n As percent of students leaving KS2: 3- = 79.2%.\n\n As percent of students entering GCSE: 6- = 12.7%.","Flow: (GCSE: 9) -> (A_level: Maths + Further) = 7\n\n As percent of students leaving GCSE: 9 = 2.5%.\n\n As percent of students entering A_level: Maths + Further = 3.4%.","Flow: (GCSE: 8) -> (A_level: Maths + Further) = 18\n\n As percent of students leaving GCSE: 8 = 2.4%.\n\n As percent of students entering A_level: Maths + Further = 8.7%.","Flow: (GCSE: 7) -> (A_level: Maths + Further) = 14\n\n As percent of students leaving GCSE: 7 = 1.4%.\n\n As percent of students entering A_level: Maths + Further = 6.8%.","Flow: (GCSE: 6-) -> (A_level: Maths + Further) = 168\n\n As percent of students leaving GCSE: 6- = 2.1%.\n\n As percent of students entering A_level: Maths + Further = 81.2%.","Flow: (GCSE: 9) -> (A_level: Maths) = 25\n\n As percent of students leaving GCSE: 9 = 8.8%.\n\n As percent of students entering A_level: Maths = 3%.","Flow: (GCSE: 8) -> (A_level: Maths) = 64\n\n As percent of students leaving GCSE: 8 = 8.6%.\n\n As percent of students entering A_level: Maths = 7.6%.","Flow: (GCSE: 7) -> (A_level: Maths) = 95\n\n As percent of students leaving GCSE: 7 = 9.3%.\n\n As percent of students entering A_level: Maths = 11.2%.","Flow: (GCSE: 6-) -> (A_level: Maths) = 661\n\n As percent of students leaving GCSE: 6- = 8.3%.\n\n As percent of students entering A_level: Maths = 78.2%.","Flow: (GCSE: 9) -> (A_level: No Maths) = 253\n\n As percent of students leaving GCSE: 9 = 88.8%.\n\n As percent of students entering A_level: No Maths = 2.8%.","Flow: (GCSE: 8) -> (A_level: No Maths) = 666\n\n As percent of students leaving GCSE: 8 = 89%.\n\n As percent of students entering A_level: No Maths = 7.4%.","Flow: (GCSE: 7) -> (A_level: No Maths) = 909\n\n As percent of students leaving GCSE: 7 = 89.3%.\n\n As percent of students entering A_level: No Maths = 10.2%.","Flow: (GCSE: 6-) -> (A_level: No Maths) = 7120\n\n As percent of students leaving GCSE: 6- = 89.6%.\n\n As percent of students entering A_level: No Maths = 79.6%."]},"nodes":{"name":["KS1: 3+","KS1: 2A","KS1: 2B","KS1: 2C-","KS2: 6","KS2: 5+","KS2: 5-","KS2: 4","KS2: 3-","GCSE: 9","GCSE: 8","GCSE: 7","GCSE: 6-","A_level: Maths + Further","A_level: Maths","A_level: No Maths"],"group":["KS1: 3+","KS1: 2A","KS1: 2B","KS1: 2C-","KS2: 6","KS2: 5+","KS2: 5-","KS2: 4","KS2: 3-","GCSE: 9","GCSE: 8","GCSE: 7","GCSE: 6-","A_level: Maths + Further","A_level: Maths","A_level: No Maths"],"state":["KS1: 3+\nTotal students out = 2091.\n\nAs % of KS1 stage.\n\tOut = 20.9%.","KS1: 2A\nTotal students out = 2710.\n\nAs % of KS1 stage.\n\tOut = 27.1%.","KS1: 2B\nTotal students out = 2724.\n\nAs % of KS1 stage.\n\tOut = 27.2%.","KS1: 2C-\nTotal students out = 2475.\n\nAs % of KS1 stage.\n\tOut = 24.8%.","KS2: 6\nTotal students in = 289.\nTotal students out = 289.\nContinuation = 100%.\n\nAs % of KS2 stage.\n\tIn = 2.9%.\n\tOut = 2.9%.","KS2: 5+\nTotal students in = 1494.\nTotal students out = 1494.\nContinuation = 100%.\n\nAs % of KS2 stage.\n\tIn = 14.9%.\n\tOut = 14.9%.","KS2: 5-\nTotal students in = 2290.\nTotal students out = 2290.\nContinuation = 100%.\n\nAs % of KS2 stage.\n\tIn = 22.9%.\n\tOut = 22.9%.","KS2: 4\nTotal students in = 4650.\nTotal students out = 4650.\nContinuation = 100%.\n\nAs % of KS2 stage.\n\tIn = 46.5%.\n\tOut = 46.5%.","KS2: 3-\nTotal students in = 1277.\nTotal students out = 1277.\nContinuation = 100%.\n\nAs % of KS2 stage.\n\tIn = 12.8%.\n\tOut = 12.8%.","GCSE: 9\nTotal students in = 285.\nTotal students out = 285.\nContinuation = 100%.\n\nAs % of GCSE stage.\n\tIn = 2.9%.\n\tOut = 2.9%.","GCSE: 8\nTotal students in = 748.\nTotal students out = 748.\nContinuation = 100%.\n\nAs % of GCSE stage.\n\tIn = 7.5%.\n\tOut = 7.5%.","GCSE: 7\nTotal students in = 1018.\nTotal students out = 1018.\nContinuation = 100%.\n\nAs % of GCSE stage.\n\tIn = 10.2%.\n\tOut = 10.2%.","GCSE: 6-\nTotal students in = 7949.\nTotal students out = 7949.\nContinuation = 100%.\n\nAs % of GCSE stage.\n\tIn = 79.5%.\n\tOut = 79.5%.","A_level: Maths + Further\nTotal students in = 207.\n\nAs % of A_level stage.\n\tIn = 2.1%.","A_level: Maths\nTotal students in = 845.\n\nAs % of A_level stage.\n\tIn = 8.5%.","A_level: No Maths\nTotal students in = 8948.\n\nAs % of A_level stage.\n\tIn = 89.5%."]},"options":{"NodeID":"names","NodeGroup":"names","LinkGroup":null,"colourScale":"d3.scaleOrdinal(d3.schemeCategory20);","fontSize":7,"fontFamily":null,"nodeWidth":15,"nodePadding":10,"units":"","margin":{"top":null,"right":null,"bottom":null,"left":null},"iterations":0,"sinksRight":false}},"evals":[],"jsHooks":{"render":[{"code":"\n            function(el, x) {\n                d3.selectAll(\".node\").select(\"title foreignObject body pre\")\n                .text(function(d) { return d.state; });\n            }\n            ","data":null},{"code":"\n  function(el, x) {\n  d3.selectAll(\".link\").select(\"title foreignObject body pre\")\n  .text(function(d) { return d.name; });\n  }\n  ","data":null}]}}</script><p>Where the <code>flow_columns</code> specifies the columns used in
pathways for the sankey diagram in order. This can be specified either
with the column numbers (2 = KS1, 3 = KS2, etc) or via the columns names
<code>flow_columns = c('KS1', 'KS2', 'GCSE', 'A_level')</code>.</p>
<p>We can use the same function to explore subsections of the pipeline
by using the <code>filters</code> input.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Only those that have GCSE grade 9.</span></span>
<span><span class="va">p</span> <span class="op">=</span> <span class="fu"><a href="../reference/sankey_filtered.html">sankey_filtered</a></span><span class="op">(</span>pathways <span class="op">=</span> <span class="va">pathways</span>, flow_columns <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span><span class="op">:</span><span class="fl">5</span><span class="op">)</span>, filters <span class="op">=</span> <span class="st">'GCSE: 9'</span><span class="op">)</span></span>
<span><span class="va">p</span></span></code></pre></div>
<div class="sankeyNetwork html-widget html-fill-item" id="htmlwidget-febe03efa1a2d8d52a86" style="width:960px;height:384px;"></div>
<script type="application/json" data-for="htmlwidget-febe03efa1a2d8d52a86">{"x":{"links":{"source":[2,3,0,1,2,3,0,1,2,3,0,1,2,3,0,1,2,3,4,5,6,7,8,9,9,9],"target":[4,4,5,5,5,5,6,6,6,6,7,7,7,7,8,8,8,8,9,9,9,9,9,10,11,12],"value":["3","4","5","10","12","4","9","23","9","23","39","43","36","31","6","9","11","8","7","31","64","149","34","7","25","253"],"name":["Flow: (KS1: 2B) -> (KS2: 6) = 3\n\n As percent of students leaving KS1: 2B = 4.2%.\n\n As percent of students entering KS2: 6 = 42.9%.","Flow: (KS1: 2C-) -> (KS2: 6) = 4\n\n As percent of students leaving KS1: 2C- = 5.7%.\n\n As percent of students entering KS2: 6 = 57.1%.","Flow: (KS1: 3+) -> (KS2: 5+) = 5\n\n As percent of students leaving KS1: 3+ = 8.5%.\n\n As percent of students entering KS2: 5+ = 16.1%.","Flow: (KS1: 2A) -> (KS2: 5+) = 10\n\n As percent of students leaving KS1: 2A = 11.8%.\n\n As percent of students entering KS2: 5+ = 32.3%.","Flow: (KS1: 2B) -> (KS2: 5+) = 12\n\n As percent of students leaving KS1: 2B = 16.9%.\n\n As percent of students entering KS2: 5+ = 38.7%.","Flow: (KS1: 2C-) -> (KS2: 5+) = 4\n\n As percent of students leaving KS1: 2C- = 5.7%.\n\n As percent of students entering KS2: 5+ = 12.9%.","Flow: (KS1: 3+) -> (KS2: 5-) = 9\n\n As percent of students leaving KS1: 3+ = 15.3%.\n\n As percent of students entering KS2: 5- = 14.1%.","Flow: (KS1: 2A) -> (KS2: 5-) = 23\n\n As percent of students leaving KS1: 2A = 27.1%.\n\n As percent of students entering KS2: 5- = 35.9%.","Flow: (KS1: 2B) -> (KS2: 5-) = 9\n\n As percent of students leaving KS1: 2B = 12.7%.\n\n As percent of students entering KS2: 5- = 14.1%.","Flow: (KS1: 2C-) -> (KS2: 5-) = 23\n\n As percent of students leaving KS1: 2C- = 32.9%.\n\n As percent of students entering KS2: 5- = 35.9%.","Flow: (KS1: 3+) -> (KS2: 4) = 39\n\n As percent of students leaving KS1: 3+ = 66.1%.\n\n As percent of students entering KS2: 4 = 26.2%.","Flow: (KS1: 2A) -> (KS2: 4) = 43\n\n As percent of students leaving KS1: 2A = 50.6%.\n\n As percent of students entering KS2: 4 = 28.9%.","Flow: (KS1: 2B) -> (KS2: 4) = 36\n\n As percent of students leaving KS1: 2B = 50.7%.\n\n As percent of students entering KS2: 4 = 24.2%.","Flow: (KS1: 2C-) -> (KS2: 4) = 31\n\n As percent of students leaving KS1: 2C- = 44.3%.\n\n As percent of students entering KS2: 4 = 20.8%.","Flow: (KS1: 3+) -> (KS2: 3-) = 6\n\n As percent of students leaving KS1: 3+ = 10.2%.\n\n As percent of students entering KS2: 3- = 17.6%.","Flow: (KS1: 2A) -> (KS2: 3-) = 9\n\n As percent of students leaving KS1: 2A = 10.6%.\n\n As percent of students entering KS2: 3- = 26.5%.","Flow: (KS1: 2B) -> (KS2: 3-) = 11\n\n As percent of students leaving KS1: 2B = 15.5%.\n\n As percent of students entering KS2: 3- = 32.4%.","Flow: (KS1: 2C-) -> (KS2: 3-) = 8\n\n As percent of students leaving KS1: 2C- = 11.4%.\n\n As percent of students entering KS2: 3- = 23.5%.","Flow: (KS2: 6) -> (GCSE: 9) = 7\n\n As percent of students leaving KS2: 6 = 100%.\n\n As percent of students entering GCSE: 9 = 2.5%.","Flow: (KS2: 5+) -> (GCSE: 9) = 31\n\n As percent of students leaving KS2: 5+ = 100%.\n\n As percent of students entering GCSE: 9 = 10.9%.","Flow: (KS2: 5-) -> (GCSE: 9) = 64\n\n As percent of students leaving KS2: 5- = 100%.\n\n As percent of students entering GCSE: 9 = 22.5%.","Flow: (KS2: 4) -> (GCSE: 9) = 149\n\n As percent of students leaving KS2: 4 = 100%.\n\n As percent of students entering GCSE: 9 = 52.3%.","Flow: (KS2: 3-) -> (GCSE: 9) = 34\n\n As percent of students leaving KS2: 3- = 100%.\n\n As percent of students entering GCSE: 9 = 11.9%.","Flow: (GCSE: 9) -> (A_level: Maths + Further) = 7\n\n As percent of students leaving GCSE: 9 = 2.5%.\n\n As percent of students entering A_level: Maths + Further = 100%.","Flow: (GCSE: 9) -> (A_level: Maths) = 25\n\n As percent of students leaving GCSE: 9 = 8.8%.\n\n As percent of students entering A_level: Maths = 100%.","Flow: (GCSE: 9) -> (A_level: No Maths) = 253\n\n As percent of students leaving GCSE: 9 = 88.8%.\n\n As percent of students entering A_level: No Maths = 100%."]},"nodes":{"name":["KS1: 3+","KS1: 2A","KS1: 2B","KS1: 2C-","KS2: 6","KS2: 5+","KS2: 5-","KS2: 4","KS2: 3-","GCSE: 9","A_level: Maths + Further","A_level: Maths","A_level: No Maths"],"group":["KS1: 3+","KS1: 2A","KS1: 2B","KS1: 2C-","KS2: 6","KS2: 5+","KS2: 5-","KS2: 4","KS2: 3-","GCSE: 9","A_level: Maths + Further","A_level: Maths","A_level: No Maths"],"state":["KS1: 3+\nTotal students out = 59.\n\nAs % of KS1 stage.\n\tOut = 20.7%.","KS1: 2A\nTotal students out = 85.\n\nAs % of KS1 stage.\n\tOut = 29.8%.","KS1: 2B\nTotal students out = 71.\n\nAs % of KS1 stage.\n\tOut = 24.9%.","KS1: 2C-\nTotal students out = 70.\n\nAs % of KS1 stage.\n\tOut = 24.6%.","KS2: 6\nTotal students in = 7.\nTotal students out = 7.\nContinuation = 100%.\n\nAs % of KS2 stage.\n\tIn = 2.5%.\n\tOut = 2.5%.","KS2: 5+\nTotal students in = 31.\nTotal students out = 31.\nContinuation = 100%.\n\nAs % of KS2 stage.\n\tIn = 10.9%.\n\tOut = 10.9%.","KS2: 5-\nTotal students in = 64.\nTotal students out = 64.\nContinuation = 100%.\n\nAs % of KS2 stage.\n\tIn = 22.5%.\n\tOut = 22.5%.","KS2: 4\nTotal students in = 149.\nTotal students out = 149.\nContinuation = 100%.\n\nAs % of KS2 stage.\n\tIn = 52.3%.\n\tOut = 52.3%.","KS2: 3-\nTotal students in = 34.\nTotal students out = 34.\nContinuation = 100%.\n\nAs % of KS2 stage.\n\tIn = 11.9%.\n\tOut = 11.9%.","GCSE: 9\nTotal students in = 285.\nTotal students out = 285.\nContinuation = 100%.\n\nAs % of GCSE stage.\n\tIn = 100%.\n\tOut = 100%.","A_level: Maths + Further\nTotal students in = 7.\n\nAs % of A_level stage.\n\tIn = 2.5%.","A_level: Maths\nTotal students in = 25.\n\nAs % of A_level stage.\n\tIn = 8.8%.","A_level: No Maths\nTotal students in = 253.\n\nAs % of A_level stage.\n\tIn = 88.8%."]},"options":{"NodeID":"names","NodeGroup":"names","LinkGroup":null,"colourScale":"d3.scaleOrdinal(d3.schemeCategory20);","fontSize":7,"fontFamily":null,"nodeWidth":15,"nodePadding":10,"units":"","margin":{"top":null,"right":null,"bottom":null,"left":null},"iterations":0,"sinksRight":false}},"evals":[],"jsHooks":{"render":[{"code":"\n            function(el, x) {\n                d3.selectAll(\".node\").select(\"title foreignObject body pre\")\n                .text(function(d) { return d.state; });\n            }\n            ","data":null},{"code":"\n  function(el, x) {\n  d3.selectAll(\".link\").select(\"title foreignObject body pre\")\n  .text(function(d) { return d.name; });\n  }\n  ","data":null}]}}</script><div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co"># Only those that have GCSE grade 9 and KS2 level 5+.</span></span>
<span><span class="va">p</span> <span class="op">=</span> <span class="fu"><a href="../reference/sankey_filtered.html">sankey_filtered</a></span><span class="op">(</span>pathways <span class="op">=</span> <span class="va">pathways</span>, flow_columns <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span><span class="op">:</span><span class="fl">5</span><span class="op">)</span>, filters <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'GCSE: 9'</span>, <span class="st">'KS2: 5+'</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">p</span></span></code></pre></div>
<div class="sankeyNetwork html-widget html-fill-item" id="htmlwidget-1fb4450895fe099f74a1" style="width:960px;height:384px;"></div>
<script type="application/json" data-for="htmlwidget-1fb4450895fe099f74a1">{"x":{"links":{"source":[0,1,2,3,4,5,5,5],"target":[4,4,4,4,5,6,7,8],"value":["5","10","12","4","31","2","2","27"],"name":["Flow: (KS1: 3+) -> (KS2: 5+) = 5\n\n As percent of students leaving KS1: 3+ = 100%.\n\n As percent of students entering KS2: 5+ = 16.1%.","Flow: (KS1: 2A) -> (KS2: 5+) = 10\n\n As percent of students leaving KS1: 2A = 100%.\n\n As percent of students entering KS2: 5+ = 32.3%.","Flow: (KS1: 2B) -> (KS2: 5+) = 12\n\n As percent of students leaving KS1: 2B = 100%.\n\n As percent of students entering KS2: 5+ = 38.7%.","Flow: (KS1: 2C-) -> (KS2: 5+) = 4\n\n As percent of students leaving KS1: 2C- = 100%.\n\n As percent of students entering KS2: 5+ = 12.9%.","Flow: (KS2: 5+) -> (GCSE: 9) = 31\n\n As percent of students leaving KS2: 5+ = 100%.\n\n As percent of students entering GCSE: 9 = 100%.","Flow: (GCSE: 9) -> (A_level: Maths + Further) = 2\n\n As percent of students leaving GCSE: 9 = 6.5%.\n\n As percent of students entering A_level: Maths + Further = 100%.","Flow: (GCSE: 9) -> (A_level: Maths) = 2\n\n As percent of students leaving GCSE: 9 = 6.5%.\n\n As percent of students entering A_level: Maths = 100%.","Flow: (GCSE: 9) -> (A_level: No Maths) = 27\n\n As percent of students leaving GCSE: 9 = 87.1%.\n\n As percent of students entering A_level: No Maths = 100%."]},"nodes":{"name":["KS1: 3+","KS1: 2A","KS1: 2B","KS1: 2C-","KS2: 5+","GCSE: 9","A_level: Maths + Further","A_level: Maths","A_level: No Maths"],"group":["KS1: 3+","KS1: 2A","KS1: 2B","KS1: 2C-","KS2: 5+","GCSE: 9","A_level: Maths + Further","A_level: Maths","A_level: No Maths"],"state":["KS1: 3+\nTotal students out = 5.\n\nAs % of KS1 stage.\n\tOut = 16.1%.","KS1: 2A\nTotal students out = 10.\n\nAs % of KS1 stage.\n\tOut = 32.3%.","KS1: 2B\nTotal students out = 12.\n\nAs % of KS1 stage.\n\tOut = 38.7%.","KS1: 2C-\nTotal students out = 4.\n\nAs % of KS1 stage.\n\tOut = 12.9%.","KS2: 5+\nTotal students in = 31.\nTotal students out = 31.\nContinuation = 100%.\n\nAs % of KS2 stage.\n\tIn = 100%.\n\tOut = 100%.","GCSE: 9\nTotal students in = 31.\nTotal students out = 31.\nContinuation = 100%.\n\nAs % of GCSE stage.\n\tIn = 100%.\n\tOut = 100%.","A_level: Maths + Further\nTotal students in = 2.\n\nAs % of A_level stage.\n\tIn = 6.5%.","A_level: Maths\nTotal students in = 2.\n\nAs % of A_level stage.\n\tIn = 6.5%.","A_level: No Maths\nTotal students in = 27.\n\nAs % of A_level stage.\n\tIn = 87.1%."]},"options":{"NodeID":"names","NodeGroup":"names","LinkGroup":null,"colourScale":"d3.scaleOrdinal(d3.schemeCategory20);","fontSize":7,"fontFamily":null,"nodeWidth":15,"nodePadding":10,"units":"","margin":{"top":null,"right":null,"bottom":null,"left":null},"iterations":0,"sinksRight":false}},"evals":[],"jsHooks":{"render":[{"code":"\n            function(el, x) {\n                d3.selectAll(\".node\").select(\"title foreignObject body pre\")\n                .text(function(d) { return d.state; });\n            }\n            ","data":null},{"code":"\n  function(el, x) {\n  d3.selectAll(\".link\").select(\"title foreignObject body pre\")\n  .text(function(d) { return d.name; });\n  }\n  ","data":null}]}}</script><div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co"># Only those that have GCSE grade 9 or grade 8.</span></span>
<span><span class="va">p</span> <span class="op">=</span> <span class="fu"><a href="../reference/sankey_filtered.html">sankey_filtered</a></span><span class="op">(</span>pathways <span class="op">=</span> <span class="va">pathways</span>, flow_columns <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span><span class="op">:</span><span class="fl">5</span><span class="op">)</span>, filters <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'GCSE: 9'</span>, <span class="st">'GCSE: 8'</span><span class="op">)</span>, union <span class="op">=</span> <span class="cn">T</span><span class="op">)</span></span>
<span><span class="va">p</span></span></code></pre></div>
<div class="sankeyNetwork html-widget html-fill-item" id="htmlwidget-10b3b7155e8045a1b2ad" style="width:960px;height:384px;"></div>
<script type="application/json" data-for="htmlwidget-10b3b7155e8045a1b2ad">{"x":{"links":{"source":[0,1,2,3,0,1,2,3,0,1,2,3,0,1,2,3,0,1,2,3,4,5,6,7,8,4,5,6,7,8,9,10,9,10,9,10],"target":[4,4,4,4,5,5,5,5,6,6,6,6,7,7,7,7,8,8,8,8,9,9,9,9,9,10,10,10,10,10,11,11,12,12,13,13],"value":["4","2","11","10","20","44","43","27","45","70","58","61","114","134","132","131","27","37","38","25","7","31","64","149","34","20","103","170","362","93","7","18","25","64","253","666"],"name":["Flow: (KS1: 3+) -> (KS2: 6) = 4\n\n As percent of students leaving KS1: 3+ = 1.9%.\n\n As percent of students entering KS2: 6 = 14.8%.","Flow: (KS1: 2A) -> (KS2: 6) = 2\n\n As percent of students leaving KS1: 2A = 0.7%.\n\n As percent of students entering KS2: 6 = 7.4%.","Flow: (KS1: 2B) -> (KS2: 6) = 11\n\n As percent of students leaving KS1: 2B = 3.9%.\n\n As percent of students entering KS2: 6 = 40.7%.","Flow: (KS1: 2C-) -> (KS2: 6) = 10\n\n As percent of students leaving KS1: 2C- = 3.9%.\n\n As percent of students entering KS2: 6 = 37%.","Flow: (KS1: 3+) -> (KS2: 5+) = 20\n\n As percent of students leaving KS1: 3+ = 9.5%.\n\n As percent of students entering KS2: 5+ = 14.9%.","Flow: (KS1: 2A) -> (KS2: 5+) = 44\n\n As percent of students leaving KS1: 2A = 15.3%.\n\n As percent of students entering KS2: 5+ = 32.8%.","Flow: (KS1: 2B) -> (KS2: 5+) = 43\n\n As percent of students leaving KS1: 2B = 15.2%.\n\n As percent of students entering KS2: 5+ = 32.1%.","Flow: (KS1: 2C-) -> (KS2: 5+) = 27\n\n As percent of students leaving KS1: 2C- = 10.6%.\n\n As percent of students entering KS2: 5+ = 20.1%.","Flow: (KS1: 3+) -> (KS2: 5-) = 45\n\n As percent of students leaving KS1: 3+ = 21.4%.\n\n As percent of students entering KS2: 5- = 19.2%.","Flow: (KS1: 2A) -> (KS2: 5-) = 70\n\n As percent of students leaving KS1: 2A = 24.4%.\n\n As percent of students entering KS2: 5- = 29.9%.","Flow: (KS1: 2B) -> (KS2: 5-) = 58\n\n As percent of students leaving KS1: 2B = 20.6%.\n\n As percent of students entering KS2: 5- = 24.8%.","Flow: (KS1: 2C-) -> (KS2: 5-) = 61\n\n As percent of students leaving KS1: 2C- = 24%.\n\n As percent of students entering KS2: 5- = 26.1%.","Flow: (KS1: 3+) -> (KS2: 4) = 114\n\n As percent of students leaving KS1: 3+ = 54.3%.\n\n As percent of students entering KS2: 4 = 22.3%.","Flow: (KS1: 2A) -> (KS2: 4) = 134\n\n As percent of students leaving KS1: 2A = 46.7%.\n\n As percent of students entering KS2: 4 = 26.2%.","Flow: (KS1: 2B) -> (KS2: 4) = 132\n\n As percent of students leaving KS1: 2B = 46.8%.\n\n As percent of students entering KS2: 4 = 25.8%.","Flow: (KS1: 2C-) -> (KS2: 4) = 131\n\n As percent of students leaving KS1: 2C- = 51.6%.\n\n As percent of students entering KS2: 4 = 25.6%.","Flow: (KS1: 3+) -> (KS2: 3-) = 27\n\n As percent of students leaving KS1: 3+ = 12.9%.\n\n As percent of students entering KS2: 3- = 21.3%.","Flow: (KS1: 2A) -> (KS2: 3-) = 37\n\n As percent of students leaving KS1: 2A = 12.9%.\n\n As percent of students entering KS2: 3- = 29.1%.","Flow: (KS1: 2B) -> (KS2: 3-) = 38\n\n As percent of students leaving KS1: 2B = 13.5%.\n\n As percent of students entering KS2: 3- = 29.9%.","Flow: (KS1: 2C-) -> (KS2: 3-) = 25\n\n As percent of students leaving KS1: 2C- = 9.8%.\n\n As percent of students entering KS2: 3- = 19.7%.","Flow: (KS2: 6) -> (GCSE: 9) = 7\n\n As percent of students leaving KS2: 6 = 25.9%.\n\n As percent of students entering GCSE: 9 = 2.5%.","Flow: (KS2: 5+) -> (GCSE: 9) = 31\n\n As percent of students leaving KS2: 5+ = 23.1%.\n\n As percent of students entering GCSE: 9 = 10.9%.","Flow: (KS2: 5-) -> (GCSE: 9) = 64\n\n As percent of students leaving KS2: 5- = 27.4%.\n\n As percent of students entering GCSE: 9 = 22.5%.","Flow: (KS2: 4) -> (GCSE: 9) = 149\n\n As percent of students leaving KS2: 4 = 29.2%.\n\n As percent of students entering GCSE: 9 = 52.3%.","Flow: (KS2: 3-) -> (GCSE: 9) = 34\n\n As percent of students leaving KS2: 3- = 26.8%.\n\n As percent of students entering GCSE: 9 = 11.9%.","Flow: (KS2: 6) -> (GCSE: 8) = 20\n\n As percent of students leaving KS2: 6 = 74.1%.\n\n As percent of students entering GCSE: 8 = 2.7%.","Flow: (KS2: 5+) -> (GCSE: 8) = 103\n\n As percent of students leaving KS2: 5+ = 76.9%.\n\n As percent of students entering GCSE: 8 = 13.8%.","Flow: (KS2: 5-) -> (GCSE: 8) = 170\n\n As percent of students leaving KS2: 5- = 72.6%.\n\n As percent of students entering GCSE: 8 = 22.7%.","Flow: (KS2: 4) -> (GCSE: 8) = 362\n\n As percent of students leaving KS2: 4 = 70.8%.\n\n As percent of students entering GCSE: 8 = 48.4%.","Flow: (KS2: 3-) -> (GCSE: 8) = 93\n\n As percent of students leaving KS2: 3- = 73.2%.\n\n As percent of students entering GCSE: 8 = 12.4%.","Flow: (GCSE: 9) -> (A_level: Maths + Further) = 7\n\n As percent of students leaving GCSE: 9 = 2.5%.\n\n As percent of students entering A_level: Maths + Further = 28%.","Flow: (GCSE: 8) -> (A_level: Maths + Further) = 18\n\n As percent of students leaving GCSE: 8 = 2.4%.\n\n As percent of students entering A_level: Maths + Further = 72%.","Flow: (GCSE: 9) -> (A_level: Maths) = 25\n\n As percent of students leaving GCSE: 9 = 8.8%.\n\n As percent of students entering A_level: Maths = 28.1%.","Flow: (GCSE: 8) -> (A_level: Maths) = 64\n\n As percent of students leaving GCSE: 8 = 8.6%.\n\n As percent of students entering A_level: Maths = 71.9%.","Flow: (GCSE: 9) -> (A_level: No Maths) = 253\n\n As percent of students leaving GCSE: 9 = 88.8%.\n\n As percent of students entering A_level: No Maths = 27.5%.","Flow: (GCSE: 8) -> (A_level: No Maths) = 666\n\n As percent of students leaving GCSE: 8 = 89%.\n\n As percent of students entering A_level: No Maths = 72.5%."]},"nodes":{"name":["KS1: 3+","KS1: 2A","KS1: 2B","KS1: 2C-","KS2: 6","KS2: 5+","KS2: 5-","KS2: 4","KS2: 3-","GCSE: 9","GCSE: 8","A_level: Maths + Further","A_level: Maths","A_level: No Maths"],"group":["KS1: 3+","KS1: 2A","KS1: 2B","KS1: 2C-","KS2: 6","KS2: 5+","KS2: 5-","KS2: 4","KS2: 3-","GCSE: 9","GCSE: 8","A_level: Maths + Further","A_level: Maths","A_level: No Maths"],"state":["KS1: 3+\nTotal students out = 210.\n\nAs % of KS1 stage.\n\tOut = 20.3%.","KS1: 2A\nTotal students out = 287.\n\nAs % of KS1 stage.\n\tOut = 27.8%.","KS1: 2B\nTotal students out = 282.\n\nAs % of KS1 stage.\n\tOut = 27.3%.","KS1: 2C-\nTotal students out = 254.\n\nAs % of KS1 stage.\n\tOut = 24.6%.","KS2: 6\nTotal students in = 27.\nTotal students out = 27.\nContinuation = 100%.\n\nAs % of KS2 stage.\n\tIn = 2.6%.\n\tOut = 2.6%.","KS2: 5+\nTotal students in = 134.\nTotal students out = 134.\nContinuation = 100%.\n\nAs % of KS2 stage.\n\tIn = 13%.\n\tOut = 13%.","KS2: 5-\nTotal students in = 234.\nTotal students out = 234.\nContinuation = 100%.\n\nAs % of KS2 stage.\n\tIn = 22.7%.\n\tOut = 22.7%.","KS2: 4\nTotal students in = 511.\nTotal students out = 511.\nContinuation = 100%.\n\nAs % of KS2 stage.\n\tIn = 49.5%.\n\tOut = 49.5%.","KS2: 3-\nTotal students in = 127.\nTotal students out = 127.\nContinuation = 100%.\n\nAs % of KS2 stage.\n\tIn = 12.3%.\n\tOut = 12.3%.","GCSE: 9\nTotal students in = 285.\nTotal students out = 285.\nContinuation = 100%.\n\nAs % of GCSE stage.\n\tIn = 27.6%.\n\tOut = 27.6%.","GCSE: 8\nTotal students in = 748.\nTotal students out = 748.\nContinuation = 100%.\n\nAs % of GCSE stage.\n\tIn = 72.4%.\n\tOut = 72.4%.","A_level: Maths + Further\nTotal students in = 25.\n\nAs % of A_level stage.\n\tIn = 2.4%.","A_level: Maths\nTotal students in = 89.\n\nAs % of A_level stage.\n\tIn = 8.6%.","A_level: No Maths\nTotal students in = 919.\n\nAs % of A_level stage.\n\tIn = 89%."]},"options":{"NodeID":"names","NodeGroup":"names","LinkGroup":null,"colourScale":"d3.scaleOrdinal(d3.schemeCategory20);","fontSize":7,"fontFamily":null,"nodeWidth":15,"nodePadding":10,"units":"","margin":{"top":null,"right":null,"bottom":null,"left":null},"iterations":0,"sinksRight":false}},"evals":[],"jsHooks":{"render":[{"code":"\n            function(el, x) {\n                d3.selectAll(\".node\").select(\"title foreignObject body pre\")\n                .text(function(d) { return d.state; });\n            }\n            ","data":null},{"code":"\n  function(el, x) {\n  d3.selectAll(\".link\").select(\"title foreignObject body pre\")\n  .text(function(d) { return d.name; });\n  }\n  ","data":null}]}}</script><p>Note that the <code>union</code> input only allows for looking at
flows through multiple nodes at a particular stage. I.e if you set
<code>union = T</code> in the example with KS2 level 5+ and GCSE grade 9
the output would be the same sankey diagram (rather than any student who
got KS2 level 5+ or GCSE grade 9).</p>
<p>As well as zooming into particular parts of the pipeline the filter
can also be used in relation to demographics as well.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Only those that have FSM status.</span></span>
<span><span class="va">p</span> <span class="op">=</span> <span class="fu"><a href="../reference/sankey_filtered.html">sankey_filtered</a></span><span class="op">(</span>pathways <span class="op">=</span> <span class="va">pathways</span>, flow_columns <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span><span class="op">:</span><span class="fl">5</span><span class="op">)</span>, filters <span class="op">=</span> <span class="st">'FSM: Yes'</span><span class="op">)</span></span>
<span><span class="va">p</span></span></code></pre></div>
<div class="sankeyNetwork html-widget html-fill-item" id="htmlwidget-4018eef1a407a0df6b52" style="width:960px;height:384px;"></div>
<script type="application/json" data-for="htmlwidget-4018eef1a407a0df6b52">{"x":{"links":{"source":[0,1,2,3,0,1,2,3,0,1,2,3,0,1,2,3,0,1,2,3,4,5,6,7,8,4,5,6,7,8,4,5,6,7,8,4,5,6,7,8,9,10,11,12,9,10,11,12,9,10,11,12],"target":[4,4,4,4,5,5,5,5,6,6,6,6,7,7,7,7,8,8,8,8,9,9,9,9,9,10,10,10,10,10,11,11,11,11,11,12,12,12,12,12,13,13,13,13,14,14,14,14,15,15,15,15],"value":["13","23","14","17","64","93","96","80","115","141","158","136","243","288","272","282","68","107","69","68","3","8","19","36","7","4","27","43","83","28","6","46","53","111","38","54","252","435","855","239","2","4","3","46","5","14","29","141","66","167","222","1648"],"name":["Flow: (KS1: 3+) -> (KS2: 6) = 13\n\n As percent of students leaving KS1: 3+ = 2.6%.\n\n As percent of students entering KS2: 6 = 19.4%.","Flow: (KS1: 2A) -> (KS2: 6) = 23\n\n As percent of students leaving KS1: 2A = 3.5%.\n\n As percent of students entering KS2: 6 = 34.3%.","Flow: (KS1: 2B) -> (KS2: 6) = 14\n\n As percent of students leaving KS1: 2B = 2.3%.\n\n As percent of students entering KS2: 6 = 20.9%.","Flow: (KS1: 2C-) -> (KS2: 6) = 17\n\n As percent of students leaving KS1: 2C- = 2.9%.\n\n As percent of students entering KS2: 6 = 25.4%.","Flow: (KS1: 3+) -> (KS2: 5+) = 64\n\n As percent of students leaving KS1: 3+ = 12.7%.\n\n As percent of students entering KS2: 5+ = 19.2%.","Flow: (KS1: 2A) -> (KS2: 5+) = 93\n\n As percent of students leaving KS1: 2A = 14.3%.\n\n As percent of students entering KS2: 5+ = 27.9%.","Flow: (KS1: 2B) -> (KS2: 5+) = 96\n\n As percent of students leaving KS1: 2B = 15.8%.\n\n As percent of students entering KS2: 5+ = 28.8%.","Flow: (KS1: 2C-) -> (KS2: 5+) = 80\n\n As percent of students leaving KS1: 2C- = 13.7%.\n\n As percent of students entering KS2: 5+ = 24%.","Flow: (KS1: 3+) -> (KS2: 5-) = 115\n\n As percent of students leaving KS1: 3+ = 22.9%.\n\n As percent of students entering KS2: 5- = 20.9%.","Flow: (KS1: 2A) -> (KS2: 5-) = 141\n\n As percent of students leaving KS1: 2A = 21.6%.\n\n As percent of students entering KS2: 5- = 25.6%.","Flow: (KS1: 2B) -> (KS2: 5-) = 158\n\n As percent of students leaving KS1: 2B = 25.9%.\n\n As percent of students entering KS2: 5- = 28.7%.","Flow: (KS1: 2C-) -> (KS2: 5-) = 136\n\n As percent of students leaving KS1: 2C- = 23.3%.\n\n As percent of students entering KS2: 5- = 24.7%.","Flow: (KS1: 3+) -> (KS2: 4) = 243\n\n As percent of students leaving KS1: 3+ = 48.3%.\n\n As percent of students entering KS2: 4 = 22.4%.","Flow: (KS1: 2A) -> (KS2: 4) = 288\n\n As percent of students leaving KS1: 2A = 44.2%.\n\n As percent of students entering KS2: 4 = 26.5%.","Flow: (KS1: 2B) -> (KS2: 4) = 272\n\n As percent of students leaving KS1: 2B = 44.7%.\n\n As percent of students entering KS2: 4 = 25.1%.","Flow: (KS1: 2C-) -> (KS2: 4) = 282\n\n As percent of students leaving KS1: 2C- = 48.4%.\n\n As percent of students entering KS2: 4 = 26%.","Flow: (KS1: 3+) -> (KS2: 3-) = 68\n\n As percent of students leaving KS1: 3+ = 13.5%.\n\n As percent of students entering KS2: 3- = 21.8%.","Flow: (KS1: 2A) -> (KS2: 3-) = 107\n\n As percent of students leaving KS1: 2A = 16.4%.\n\n As percent of students entering KS2: 3- = 34.3%.","Flow: (KS1: 2B) -> (KS2: 3-) = 69\n\n As percent of students leaving KS1: 2B = 11.3%.\n\n As percent of students entering KS2: 3- = 22.1%.","Flow: (KS1: 2C-) -> (KS2: 3-) = 68\n\n As percent of students leaving KS1: 2C- = 11.7%.\n\n As percent of students entering KS2: 3- = 21.8%.","Flow: (KS2: 6) -> (GCSE: 9) = 3\n\n As percent of students leaving KS2: 6 = 4.5%.\n\n As percent of students entering GCSE: 9 = 4.1%.","Flow: (KS2: 5+) -> (GCSE: 9) = 8\n\n As percent of students leaving KS2: 5+ = 2.4%.\n\n As percent of students entering GCSE: 9 = 11%.","Flow: (KS2: 5-) -> (GCSE: 9) = 19\n\n As percent of students leaving KS2: 5- = 3.5%.\n\n As percent of students entering GCSE: 9 = 26%.","Flow: (KS2: 4) -> (GCSE: 9) = 36\n\n As percent of students leaving KS2: 4 = 3.3%.\n\n As percent of students entering GCSE: 9 = 49.3%.","Flow: (KS2: 3-) -> (GCSE: 9) = 7\n\n As percent of students leaving KS2: 3- = 2.2%.\n\n As percent of students entering GCSE: 9 = 9.6%.","Flow: (KS2: 6) -> (GCSE: 8) = 4\n\n As percent of students leaving KS2: 6 = 6%.\n\n As percent of students entering GCSE: 8 = 2.2%.","Flow: (KS2: 5+) -> (GCSE: 8) = 27\n\n As percent of students leaving KS2: 5+ = 8.1%.\n\n As percent of students entering GCSE: 8 = 14.6%.","Flow: (KS2: 5-) -> (GCSE: 8) = 43\n\n As percent of students leaving KS2: 5- = 7.8%.\n\n As percent of students entering GCSE: 8 = 23.2%.","Flow: (KS2: 4) -> (GCSE: 8) = 83\n\n As percent of students leaving KS2: 4 = 7.6%.\n\n As percent of students entering GCSE: 8 = 44.9%.","Flow: (KS2: 3-) -> (GCSE: 8) = 28\n\n As percent of students leaving KS2: 3- = 9%.\n\n As percent of students entering GCSE: 8 = 15.1%.","Flow: (KS2: 6) -> (GCSE: 7) = 6\n\n As percent of students leaving KS2: 6 = 9%.\n\n As percent of students entering GCSE: 7 = 2.4%.","Flow: (KS2: 5+) -> (GCSE: 7) = 46\n\n As percent of students leaving KS2: 5+ = 13.8%.\n\n As percent of students entering GCSE: 7 = 18.1%.","Flow: (KS2: 5-) -> (GCSE: 7) = 53\n\n As percent of students leaving KS2: 5- = 9.6%.\n\n As percent of students entering GCSE: 7 = 20.9%.","Flow: (KS2: 4) -> (GCSE: 7) = 111\n\n As percent of students leaving KS2: 4 = 10.2%.\n\n As percent of students entering GCSE: 7 = 43.7%.","Flow: (KS2: 3-) -> (GCSE: 7) = 38\n\n As percent of students leaving KS2: 3- = 12.2%.\n\n As percent of students entering GCSE: 7 = 15%.","Flow: (KS2: 6) -> (GCSE: 6-) = 54\n\n As percent of students leaving KS2: 6 = 80.6%.\n\n As percent of students entering GCSE: 6- = 2.9%.","Flow: (KS2: 5+) -> (GCSE: 6-) = 252\n\n As percent of students leaving KS2: 5+ = 75.7%.\n\n As percent of students entering GCSE: 6- = 13.7%.","Flow: (KS2: 5-) -> (GCSE: 6-) = 435\n\n As percent of students leaving KS2: 5- = 79.1%.\n\n As percent of students entering GCSE: 6- = 23.7%.","Flow: (KS2: 4) -> (GCSE: 6-) = 855\n\n As percent of students leaving KS2: 4 = 78.8%.\n\n As percent of students entering GCSE: 6- = 46.6%.","Flow: (KS2: 3-) -> (GCSE: 6-) = 239\n\n As percent of students leaving KS2: 3- = 76.6%.\n\n As percent of students entering GCSE: 6- = 13%.","Flow: (GCSE: 9) -> (A_level: Maths + Further) = 2\n\n As percent of students leaving GCSE: 9 = 2.7%.\n\n As percent of students entering A_level: Maths + Further = 3.6%.","Flow: (GCSE: 8) -> (A_level: Maths + Further) = 4\n\n As percent of students leaving GCSE: 8 = 2.2%.\n\n As percent of students entering A_level: Maths + Further = 7.3%.","Flow: (GCSE: 7) -> (A_level: Maths + Further) = 3\n\n As percent of students leaving GCSE: 7 = 1.2%.\n\n As percent of students entering A_level: Maths + Further = 5.5%.","Flow: (GCSE: 6-) -> (A_level: Maths + Further) = 46\n\n As percent of students leaving GCSE: 6- = 2.5%.\n\n As percent of students entering A_level: Maths + Further = 83.6%.","Flow: (GCSE: 9) -> (A_level: Maths) = 5\n\n As percent of students leaving GCSE: 9 = 6.8%.\n\n As percent of students entering A_level: Maths = 2.6%.","Flow: (GCSE: 8) -> (A_level: Maths) = 14\n\n As percent of students leaving GCSE: 8 = 7.6%.\n\n As percent of students entering A_level: Maths = 7.4%.","Flow: (GCSE: 7) -> (A_level: Maths) = 29\n\n As percent of students leaving GCSE: 7 = 11.4%.\n\n As percent of students entering A_level: Maths = 15.3%.","Flow: (GCSE: 6-) -> (A_level: Maths) = 141\n\n As percent of students leaving GCSE: 6- = 7.7%.\n\n As percent of students entering A_level: Maths = 74.6%.","Flow: (GCSE: 9) -> (A_level: No Maths) = 66\n\n As percent of students leaving GCSE: 9 = 90.4%.\n\n As percent of students entering A_level: No Maths = 3.1%.","Flow: (GCSE: 8) -> (A_level: No Maths) = 167\n\n As percent of students leaving GCSE: 8 = 90.3%.\n\n As percent of students entering A_level: No Maths = 7.9%.","Flow: (GCSE: 7) -> (A_level: No Maths) = 222\n\n As percent of students leaving GCSE: 7 = 87.4%.\n\n As percent of students entering A_level: No Maths = 10.6%.","Flow: (GCSE: 6-) -> (A_level: No Maths) = 1648\n\n As percent of students leaving GCSE: 6- = 89.8%.\n\n As percent of students entering A_level: No Maths = 78.4%."]},"nodes":{"name":["KS1: 3+","KS1: 2A","KS1: 2B","KS1: 2C-","KS2: 6","KS2: 5+","KS2: 5-","KS2: 4","KS2: 3-","GCSE: 9","GCSE: 8","GCSE: 7","GCSE: 6-","A_level: Maths + Further","A_level: Maths","A_level: No Maths"],"group":["KS1: 3+","KS1: 2A","KS1: 2B","KS1: 2C-","KS2: 6","KS2: 5+","KS2: 5-","KS2: 4","KS2: 3-","GCSE: 9","GCSE: 8","GCSE: 7","GCSE: 6-","A_level: Maths + Further","A_level: Maths","A_level: No Maths"],"state":["KS1: 3+\nTotal students out = 503.\n\nAs % of KS1 stage.\n\tOut = 21.4%.","KS1: 2A\nTotal students out = 652.\n\nAs % of KS1 stage.\n\tOut = 27.8%.","KS1: 2B\nTotal students out = 609.\n\nAs % of KS1 stage.\n\tOut = 25.9%.","KS1: 2C-\nTotal students out = 583.\n\nAs % of KS1 stage.\n\tOut = 24.8%.","KS2: 6\nTotal students in = 67.\nTotal students out = 67.\nContinuation = 100%.\n\nAs % of KS2 stage.\n\tIn = 2.9%.\n\tOut = 2.9%.","KS2: 5+\nTotal students in = 333.\nTotal students out = 333.\nContinuation = 100%.\n\nAs % of KS2 stage.\n\tIn = 14.2%.\n\tOut = 14.2%.","KS2: 5-\nTotal students in = 550.\nTotal students out = 550.\nContinuation = 100%.\n\nAs % of KS2 stage.\n\tIn = 23.4%.\n\tOut = 23.4%.","KS2: 4\nTotal students in = 1085.\nTotal students out = 1085.\nContinuation = 100%.\n\nAs % of KS2 stage.\n\tIn = 46.2%.\n\tOut = 46.2%.","KS2: 3-\nTotal students in = 312.\nTotal students out = 312.\nContinuation = 100%.\n\nAs % of KS2 stage.\n\tIn = 13.3%.\n\tOut = 13.3%.","GCSE: 9\nTotal students in = 73.\nTotal students out = 73.\nContinuation = 100%.\n\nAs % of GCSE stage.\n\tIn = 3.1%.\n\tOut = 3.1%.","GCSE: 8\nTotal students in = 185.\nTotal students out = 185.\nContinuation = 100%.\n\nAs % of GCSE stage.\n\tIn = 7.9%.\n\tOut = 7.9%.","GCSE: 7\nTotal students in = 254.\nTotal students out = 254.\nContinuation = 100%.\n\nAs % of GCSE stage.\n\tIn = 10.8%.\n\tOut = 10.8%.","GCSE: 6-\nTotal students in = 1835.\nTotal students out = 1835.\nContinuation = 100%.\n\nAs % of GCSE stage.\n\tIn = 78.2%.\n\tOut = 78.2%.","A_level: Maths + Further\nTotal students in = 55.\n\nAs % of A_level stage.\n\tIn = 2.3%.","A_level: Maths\nTotal students in = 189.\n\nAs % of A_level stage.\n\tIn = 8.1%.","A_level: No Maths\nTotal students in = 2103.\n\nAs % of A_level stage.\n\tIn = 89.6%."]},"options":{"NodeID":"names","NodeGroup":"names","LinkGroup":null,"colourScale":"d3.scaleOrdinal(d3.schemeCategory20);","fontSize":7,"fontFamily":null,"nodeWidth":15,"nodePadding":10,"units":"","margin":{"top":null,"right":null,"bottom":null,"left":null},"iterations":0,"sinksRight":false}},"evals":[],"jsHooks":{"render":[{"code":"\n            function(el, x) {\n                d3.selectAll(\".node\").select(\"title foreignObject body pre\")\n                .text(function(d) { return d.state; });\n            }\n            ","data":null},{"code":"\n  function(el, x) {\n  d3.selectAll(\".link\").select(\"title foreignObject body pre\")\n  .text(function(d) { return d.name; });\n  }\n  ","data":null}]}}</script><div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co"># Only those that are FSM and got a grade 9 at GCSE.</span></span>
<span><span class="va">p</span> <span class="op">=</span> <span class="fu"><a href="../reference/sankey_filtered.html">sankey_filtered</a></span><span class="op">(</span>pathways <span class="op">=</span> <span class="va">pathways</span>, flow_columns <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span><span class="op">:</span><span class="fl">5</span><span class="op">)</span>, filters <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'GCSE: 9'</span>, <span class="st">'FSM: Yes'</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">p</span></span></code></pre></div>
<div class="sankeyNetwork html-widget html-fill-item" id="htmlwidget-5b1b2f4ad92281566982" style="width:960px;height:384px;"></div>
<script type="application/json" data-for="htmlwidget-5b1b2f4ad92281566982">{"x":{"links":{"source":[2,3,0,2,3,0,1,2,3,0,1,2,3,0,1,2,3,4,5,6,7,8,9,9,9],"target":[4,4,5,5,5,6,6,6,6,7,7,7,7,8,8,8,8,9,9,9,9,9,10,11,12],"value":["2","1","2","4","2","2","7","1","9","7","7","10","12","2","2","2","1","3","8","19","36","7","2","5","66"],"name":["Flow: (KS1: 2B) -> (KS2: 6) = 2\n\n As percent of students leaving KS1: 2B = 10.5%.\n\n As percent of students entering KS2: 6 = 66.7%.","Flow: (KS1: 2C-) -> (KS2: 6) = 1\n\n As percent of students leaving KS1: 2C- = 4%.\n\n As percent of students entering KS2: 6 = 33.3%.","Flow: (KS1: 3+) -> (KS2: 5+) = 2\n\n As percent of students leaving KS1: 3+ = 15.4%.\n\n As percent of students entering KS2: 5+ = 25%.","Flow: (KS1: 2B) -> (KS2: 5+) = 4\n\n As percent of students leaving KS1: 2B = 21.1%.\n\n As percent of students entering KS2: 5+ = 50%.","Flow: (KS1: 2C-) -> (KS2: 5+) = 2\n\n As percent of students leaving KS1: 2C- = 8%.\n\n As percent of students entering KS2: 5+ = 25%.","Flow: (KS1: 3+) -> (KS2: 5-) = 2\n\n As percent of students leaving KS1: 3+ = 15.4%.\n\n As percent of students entering KS2: 5- = 10.5%.","Flow: (KS1: 2A) -> (KS2: 5-) = 7\n\n As percent of students leaving KS1: 2A = 43.8%.\n\n As percent of students entering KS2: 5- = 36.8%.","Flow: (KS1: 2B) -> (KS2: 5-) = 1\n\n As percent of students leaving KS1: 2B = 5.3%.\n\n As percent of students entering KS2: 5- = 5.3%.","Flow: (KS1: 2C-) -> (KS2: 5-) = 9\n\n As percent of students leaving KS1: 2C- = 36%.\n\n As percent of students entering KS2: 5- = 47.4%.","Flow: (KS1: 3+) -> (KS2: 4) = 7\n\n As percent of students leaving KS1: 3+ = 53.8%.\n\n As percent of students entering KS2: 4 = 19.4%.","Flow: (KS1: 2A) -> (KS2: 4) = 7\n\n As percent of students leaving KS1: 2A = 43.8%.\n\n As percent of students entering KS2: 4 = 19.4%.","Flow: (KS1: 2B) -> (KS2: 4) = 10\n\n As percent of students leaving KS1: 2B = 52.6%.\n\n As percent of students entering KS2: 4 = 27.8%.","Flow: (KS1: 2C-) -> (KS2: 4) = 12\n\n As percent of students leaving KS1: 2C- = 48%.\n\n As percent of students entering KS2: 4 = 33.3%.","Flow: (KS1: 3+) -> (KS2: 3-) = 2\n\n As percent of students leaving KS1: 3+ = 15.4%.\n\n As percent of students entering KS2: 3- = 28.6%.","Flow: (KS1: 2A) -> (KS2: 3-) = 2\n\n As percent of students leaving KS1: 2A = 12.5%.\n\n As percent of students entering KS2: 3- = 28.6%.","Flow: (KS1: 2B) -> (KS2: 3-) = 2\n\n As percent of students leaving KS1: 2B = 10.5%.\n\n As percent of students entering KS2: 3- = 28.6%.","Flow: (KS1: 2C-) -> (KS2: 3-) = 1\n\n As percent of students leaving KS1: 2C- = 4%.\n\n As percent of students entering KS2: 3- = 14.3%.","Flow: (KS2: 6) -> (GCSE: 9) = 3\n\n As percent of students leaving KS2: 6 = 100%.\n\n As percent of students entering GCSE: 9 = 4.1%.","Flow: (KS2: 5+) -> (GCSE: 9) = 8\n\n As percent of students leaving KS2: 5+ = 100%.\n\n As percent of students entering GCSE: 9 = 11%.","Flow: (KS2: 5-) -> (GCSE: 9) = 19\n\n As percent of students leaving KS2: 5- = 100%.\n\n As percent of students entering GCSE: 9 = 26%.","Flow: (KS2: 4) -> (GCSE: 9) = 36\n\n As percent of students leaving KS2: 4 = 100%.\n\n As percent of students entering GCSE: 9 = 49.3%.","Flow: (KS2: 3-) -> (GCSE: 9) = 7\n\n As percent of students leaving KS2: 3- = 100%.\n\n As percent of students entering GCSE: 9 = 9.6%.","Flow: (GCSE: 9) -> (A_level: Maths + Further) = 2\n\n As percent of students leaving GCSE: 9 = 2.7%.\n\n As percent of students entering A_level: Maths + Further = 100%.","Flow: (GCSE: 9) -> (A_level: Maths) = 5\n\n As percent of students leaving GCSE: 9 = 6.8%.\n\n As percent of students entering A_level: Maths = 100%.","Flow: (GCSE: 9) -> (A_level: No Maths) = 66\n\n As percent of students leaving GCSE: 9 = 90.4%.\n\n As percent of students entering A_level: No Maths = 100%."]},"nodes":{"name":["KS1: 3+","KS1: 2A","KS1: 2B","KS1: 2C-","KS2: 6","KS2: 5+","KS2: 5-","KS2: 4","KS2: 3-","GCSE: 9","A_level: Maths + Further","A_level: Maths","A_level: No Maths"],"group":["KS1: 3+","KS1: 2A","KS1: 2B","KS1: 2C-","KS2: 6","KS2: 5+","KS2: 5-","KS2: 4","KS2: 3-","GCSE: 9","A_level: Maths + Further","A_level: Maths","A_level: No Maths"],"state":["KS1: 3+\nTotal students out = 13.\n\nAs % of KS1 stage.\n\tOut = 17.8%.","KS1: 2A\nTotal students out = 16.\n\nAs % of KS1 stage.\n\tOut = 21.9%.","KS1: 2B\nTotal students out = 19.\n\nAs % of KS1 stage.\n\tOut = 26%.","KS1: 2C-\nTotal students out = 25.\n\nAs % of KS1 stage.\n\tOut = 34.2%.","KS2: 6\nTotal students in = 3.\nTotal students out = 3.\nContinuation = 100%.\n\nAs % of KS2 stage.\n\tIn = 4.1%.\n\tOut = 4.1%.","KS2: 5+\nTotal students in = 8.\nTotal students out = 8.\nContinuation = 100%.\n\nAs % of KS2 stage.\n\tIn = 11%.\n\tOut = 11%.","KS2: 5-\nTotal students in = 19.\nTotal students out = 19.\nContinuation = 100%.\n\nAs % of KS2 stage.\n\tIn = 26%.\n\tOut = 26%.","KS2: 4\nTotal students in = 36.\nTotal students out = 36.\nContinuation = 100%.\n\nAs % of KS2 stage.\n\tIn = 49.3%.\n\tOut = 49.3%.","KS2: 3-\nTotal students in = 7.\nTotal students out = 7.\nContinuation = 100%.\n\nAs % of KS2 stage.\n\tIn = 9.6%.\n\tOut = 9.6%.","GCSE: 9\nTotal students in = 73.\nTotal students out = 73.\nContinuation = 100%.\n\nAs % of GCSE stage.\n\tIn = 100%.\n\tOut = 100%.","A_level: Maths + Further\nTotal students in = 2.\n\nAs % of A_level stage.\n\tIn = 2.7%.","A_level: Maths\nTotal students in = 5.\n\nAs % of A_level stage.\n\tIn = 6.8%.","A_level: No Maths\nTotal students in = 66.\n\nAs % of A_level stage.\n\tIn = 90.4%."]},"options":{"NodeID":"names","NodeGroup":"names","LinkGroup":null,"colourScale":"d3.scaleOrdinal(d3.schemeCategory20);","fontSize":7,"fontFamily":null,"nodeWidth":15,"nodePadding":10,"units":"","margin":{"top":null,"right":null,"bottom":null,"left":null},"iterations":0,"sinksRight":false}},"evals":[],"jsHooks":{"render":[{"code":"\n            function(el, x) {\n                d3.selectAll(\".node\").select(\"title foreignObject body pre\")\n                .text(function(d) { return d.state; });\n            }\n            ","data":null},{"code":"\n  function(el, x) {\n  d3.selectAll(\".link\").select(\"title foreignObject body pre\")\n  .text(function(d) { return d.name; });\n  }\n  ","data":null}]}}</script><p>If we instead want to ‘trace’ the students of interest within the
whole system we can use the <code><a href="../reference/sankey_trace.html">sankey_trace()</a></code> function, where
instead of ‘filters’ we enter the students we want to trace by the
<code>split_by</code> input.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Only those that have FSM status.</span></span>
<span><span class="va">p</span> <span class="op">=</span> <span class="fu"><a href="../reference/sankey_trace.html">sankey_trace</a></span><span class="op">(</span>pathways <span class="op">=</span> <span class="va">pathways</span>, flow_columns <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span><span class="op">:</span><span class="fl">5</span><span class="op">)</span>, split_by <span class="op">=</span> <span class="st">'FSM: Yes'</span><span class="op">)</span></span>
<span><span class="va">p</span></span></code></pre></div>
<div class="sankeyNetwork html-widget html-fill-item" id="htmlwidget-25c3e940e6859592f801" style="width:960px;height:384px;"></div>
<script type="application/json" data-for="htmlwidget-25c3e940e6859592f801">{"x":{"links":{"source":[0,1,2,3,0,1,2,3,0,1,2,3,0,1,2,3,0,1,2,3,4,5,6,7,8,4,5,6,7,8,4,5,6,7,8,4,5,6,7,8,9,10,11,12,9,10,11,12,9,10,11,12,0,1,2,3,0,1,2,3,0,1,2,3,0,1,2,3,0,1,2,3,4,5,6,7,8,4,5,6,7,8,4,5,6,7,8,4,5,6,7,8,9,10,11,12,9,10,11,12,9,10,11,12],"target":[4,4,4,4,5,5,5,5,6,6,6,6,7,7,7,7,8,8,8,8,9,9,9,9,9,10,10,10,10,10,11,11,11,11,11,12,12,12,12,12,13,13,13,13,14,14,14,14,15,15,15,15,4,4,4,4,5,5,5,5,6,6,6,6,7,7,7,7,8,8,8,8,9,9,9,9,9,10,10,10,10,10,11,11,11,11,11,12,12,12,12,12,13,13,13,13,14,14,14,14,15,15,15,15],"value":["13","23","14","17","64","93","96","80","115","141","158","136","243","288","272","282","68","107","69","68","3","8","19","36","7","4","27","43","83","28","6","46","53","111","38","54","252","435","855","239","2","4","3","46","5","14","29","141","66","167","222","1648","45","60","60","57","253","322","313","273","345","467","503","425","749","954","969","893","196","255","270","244","4","23","45","113","27","16","76","127","279","65","23","129","175","336","101","179","933","1393","2837","772","5","14","11","122","20","50","66","520","187","499","687","5472"],"group":["type_a","type_a","type_a","type_a","type_a","type_a","type_a","type_a","type_a","type_a","type_a","type_a","type_a","type_a","type_a","type_a","type_a","type_a","type_a","type_a","type_a","type_a","type_a","type_a","type_a","type_a","type_a","type_a","type_a","type_a","type_a","type_a","type_a","type_a","type_a","type_a","type_a","type_a","type_a","type_a","type_a","type_a","type_a","type_a","type_a","type_a","type_a","type_a","type_a","type_a","type_a","type_a","type_b","type_b","type_b","type_b","type_b","type_b","type_b","type_b","type_b","type_b","type_b","type_b","type_b","type_b","type_b","type_b","type_b","type_b","type_b","type_b","type_b","type_b","type_b","type_b","type_b","type_b","type_b","type_b","type_b","type_b","type_b","type_b","type_b","type_b","type_b","type_b","type_b","type_b","type_b","type_b","type_b","type_b","type_b","type_b","type_b","type_b","type_b","type_b","type_b","type_b","type_b","type_b"],"name":["Flow for students in: FSM: Yes.\nFlow: (KS1: 3+) -> (KS2: 6) = 13 (22.4%)","Flow for students in: FSM: Yes.\nFlow: (KS1: 2A) -> (KS2: 6) = 23 (27.7%)","Flow for students in: FSM: Yes.\nFlow: (KS1: 2B) -> (KS2: 6) = 14 (18.9%)","Flow for students in: FSM: Yes.\nFlow: (KS1: 2C-) -> (KS2: 6) = 17 (23%)","Flow for students in: FSM: Yes.\nFlow: (KS1: 3+) -> (KS2: 5+) = 64 (20.2%)","Flow for students in: FSM: Yes.\nFlow: (KS1: 2A) -> (KS2: 5+) = 93 (22.4%)","Flow for students in: FSM: Yes.\nFlow: (KS1: 2B) -> (KS2: 5+) = 96 (23.5%)","Flow for students in: FSM: Yes.\nFlow: (KS1: 2C-) -> (KS2: 5+) = 80 (22.7%)","Flow for students in: FSM: Yes.\nFlow: (KS1: 3+) -> (KS2: 5-) = 115 (25%)","Flow for students in: FSM: Yes.\nFlow: (KS1: 2A) -> (KS2: 5-) = 141 (23.2%)","Flow for students in: FSM: Yes.\nFlow: (KS1: 2B) -> (KS2: 5-) = 158 (23.9%)","Flow for students in: FSM: Yes.\nFlow: (KS1: 2C-) -> (KS2: 5-) = 136 (24.2%)","Flow for students in: FSM: Yes.\nFlow: (KS1: 3+) -> (KS2: 4) = 243 (24.5%)","Flow for students in: FSM: Yes.\nFlow: (KS1: 2A) -> (KS2: 4) = 288 (23.2%)","Flow for students in: FSM: Yes.\nFlow: (KS1: 2B) -> (KS2: 4) = 272 (21.9%)","Flow for students in: FSM: Yes.\nFlow: (KS1: 2C-) -> (KS2: 4) = 282 (24%)","Flow for students in: FSM: Yes.\nFlow: (KS1: 3+) -> (KS2: 3-) = 68 (25.8%)","Flow for students in: FSM: Yes.\nFlow: (KS1: 2A) -> (KS2: 3-) = 107 (29.6%)","Flow for students in: FSM: Yes.\nFlow: (KS1: 2B) -> (KS2: 3-) = 69 (20.4%)","Flow for students in: FSM: Yes.\nFlow: (KS1: 2C-) -> (KS2: 3-) = 68 (21.8%)","Flow for students in: FSM: Yes.\nFlow: (KS2: 6) -> (GCSE: 9) = 3 (42.9%)","Flow for students in: FSM: Yes.\nFlow: (KS2: 5+) -> (GCSE: 9) = 8 (25.8%)","Flow for students in: FSM: Yes.\nFlow: (KS2: 5-) -> (GCSE: 9) = 19 (29.7%)","Flow for students in: FSM: Yes.\nFlow: (KS2: 4) -> (GCSE: 9) = 36 (24.2%)","Flow for students in: FSM: Yes.\nFlow: (KS2: 3-) -> (GCSE: 9) = 7 (20.6%)","Flow for students in: FSM: Yes.\nFlow: (KS2: 6) -> (GCSE: 8) = 4 (20%)","Flow for students in: FSM: Yes.\nFlow: (KS2: 5+) -> (GCSE: 8) = 27 (26.2%)","Flow for students in: FSM: Yes.\nFlow: (KS2: 5-) -> (GCSE: 8) = 43 (25.3%)","Flow for students in: FSM: Yes.\nFlow: (KS2: 4) -> (GCSE: 8) = 83 (22.9%)","Flow for students in: FSM: Yes.\nFlow: (KS2: 3-) -> (GCSE: 8) = 28 (30.1%)","Flow for students in: FSM: Yes.\nFlow: (KS2: 6) -> (GCSE: 7) = 6 (20.7%)","Flow for students in: FSM: Yes.\nFlow: (KS2: 5+) -> (GCSE: 7) = 46 (26.3%)","Flow for students in: FSM: Yes.\nFlow: (KS2: 5-) -> (GCSE: 7) = 53 (23.2%)","Flow for students in: FSM: Yes.\nFlow: (KS2: 4) -> (GCSE: 7) = 111 (24.8%)","Flow for students in: FSM: Yes.\nFlow: (KS2: 3-) -> (GCSE: 7) = 38 (27.3%)","Flow for students in: FSM: Yes.\nFlow: (KS2: 6) -> (GCSE: 6-) = 54 (23.2%)","Flow for students in: FSM: Yes.\nFlow: (KS2: 5+) -> (GCSE: 6-) = 252 (21.3%)","Flow for students in: FSM: Yes.\nFlow: (KS2: 5-) -> (GCSE: 6-) = 435 (23.8%)","Flow for students in: FSM: Yes.\nFlow: (KS2: 4) -> (GCSE: 6-) = 855 (23.2%)","Flow for students in: FSM: Yes.\nFlow: (KS2: 3-) -> (GCSE: 6-) = 239 (23.6%)","Flow for students in: FSM: Yes.\nFlow: (GCSE: 9) -> (A_level: Maths + Further) = 2 (28.6%)","Flow for students in: FSM: Yes.\nFlow: (GCSE: 8) -> (A_level: Maths + Further) = 4 (22.2%)","Flow for students in: FSM: Yes.\nFlow: (GCSE: 7) -> (A_level: Maths + Further) = 3 (21.4%)","Flow for students in: FSM: Yes.\nFlow: (GCSE: 6-) -> (A_level: Maths + Further) = 46 (27.4%)","Flow for students in: FSM: Yes.\nFlow: (GCSE: 9) -> (A_level: Maths) = 5 (20%)","Flow for students in: FSM: Yes.\nFlow: (GCSE: 8) -> (A_level: Maths) = 14 (21.9%)","Flow for students in: FSM: Yes.\nFlow: (GCSE: 7) -> (A_level: Maths) = 29 (30.5%)","Flow for students in: FSM: Yes.\nFlow: (GCSE: 6-) -> (A_level: Maths) = 141 (21.3%)","Flow for students in: FSM: Yes.\nFlow: (GCSE: 9) -> (A_level: No Maths) = 66 (26.1%)","Flow for students in: FSM: Yes.\nFlow: (GCSE: 8) -> (A_level: No Maths) = 167 (25.1%)","Flow for students in: FSM: Yes.\nFlow: (GCSE: 7) -> (A_level: No Maths) = 222 (24.4%)","Flow for students in: FSM: Yes.\nFlow: (GCSE: 6-) -> (A_level: No Maths) = 1648 (23.1%)","Flow for students not in: FSM: Yes.\nFlow: (KS1: 3+) -> (KS2: 6) = 45 (77.6%)","Flow for students not in: FSM: Yes.\nFlow: (KS1: 2A) -> (KS2: 6) = 60 (72.3%)","Flow for students not in: FSM: Yes.\nFlow: (KS1: 2B) -> (KS2: 6) = 60 (81.1%)","Flow for students not in: FSM: Yes.\nFlow: (KS1: 2C-) -> (KS2: 6) = 57 (77%)","Flow for students not in: FSM: Yes.\nFlow: (KS1: 3+) -> (KS2: 5+) = 253 (79.8%)","Flow for students not in: FSM: Yes.\nFlow: (KS1: 2A) -> (KS2: 5+) = 322 (77.6%)","Flow for students not in: FSM: Yes.\nFlow: (KS1: 2B) -> (KS2: 5+) = 313 (76.5%)","Flow for students not in: FSM: Yes.\nFlow: (KS1: 2C-) -> (KS2: 5+) = 273 (77.3%)","Flow for students not in: FSM: Yes.\nFlow: (KS1: 3+) -> (KS2: 5-) = 345 (75%)","Flow for students not in: FSM: Yes.\nFlow: (KS1: 2A) -> (KS2: 5-) = 467 (76.8%)","Flow for students not in: FSM: Yes.\nFlow: (KS1: 2B) -> (KS2: 5-) = 503 (76.1%)","Flow for students not in: FSM: Yes.\nFlow: (KS1: 2C-) -> (KS2: 5-) = 425 (75.8%)","Flow for students not in: FSM: Yes.\nFlow: (KS1: 3+) -> (KS2: 4) = 749 (75.5%)","Flow for students not in: FSM: Yes.\nFlow: (KS1: 2A) -> (KS2: 4) = 954 (76.8%)","Flow for students not in: FSM: Yes.\nFlow: (KS1: 2B) -> (KS2: 4) = 969 (78.1%)","Flow for students not in: FSM: Yes.\nFlow: (KS1: 2C-) -> (KS2: 4) = 893 (76%)","Flow for students not in: FSM: Yes.\nFlow: (KS1: 3+) -> (KS2: 3-) = 196 (74.2%)","Flow for students not in: FSM: Yes.\nFlow: (KS1: 2A) -> (KS2: 3-) = 255 (70.4%)","Flow for students not in: FSM: Yes.\nFlow: (KS1: 2B) -> (KS2: 3-) = 270 (79.6%)","Flow for students not in: FSM: Yes.\nFlow: (KS1: 2C-) -> (KS2: 3-) = 244 (78.2%)","Flow for students not in: FSM: Yes.\nFlow: (KS2: 6) -> (GCSE: 9) = 4 (57.1%)","Flow for students not in: FSM: Yes.\nFlow: (KS2: 5+) -> (GCSE: 9) = 23 (74.2%)","Flow for students not in: FSM: Yes.\nFlow: (KS2: 5-) -> (GCSE: 9) = 45 (70.3%)","Flow for students not in: FSM: Yes.\nFlow: (KS2: 4) -> (GCSE: 9) = 113 (75.8%)","Flow for students not in: FSM: Yes.\nFlow: (KS2: 3-) -> (GCSE: 9) = 27 (79.4%)","Flow for students not in: FSM: Yes.\nFlow: (KS2: 6) -> (GCSE: 8) = 16 (80%)","Flow for students not in: FSM: Yes.\nFlow: (KS2: 5+) -> (GCSE: 8) = 76 (73.8%)","Flow for students not in: FSM: Yes.\nFlow: (KS2: 5-) -> (GCSE: 8) = 127 (74.7%)","Flow for students not in: FSM: Yes.\nFlow: (KS2: 4) -> (GCSE: 8) = 279 (77.1%)","Flow for students not in: FSM: Yes.\nFlow: (KS2: 3-) -> (GCSE: 8) = 65 (69.9%)","Flow for students not in: FSM: Yes.\nFlow: (KS2: 6) -> (GCSE: 7) = 23 (79.3%)","Flow for students not in: FSM: Yes.\nFlow: (KS2: 5+) -> (GCSE: 7) = 129 (73.7%)","Flow for students not in: FSM: Yes.\nFlow: (KS2: 5-) -> (GCSE: 7) = 175 (76.8%)","Flow for students not in: FSM: Yes.\nFlow: (KS2: 4) -> (GCSE: 7) = 336 (75.2%)","Flow for students not in: FSM: Yes.\nFlow: (KS2: 3-) -> (GCSE: 7) = 101 (72.7%)","Flow for students not in: FSM: Yes.\nFlow: (KS2: 6) -> (GCSE: 6-) = 179 (76.8%)","Flow for students not in: FSM: Yes.\nFlow: (KS2: 5+) -> (GCSE: 6-) = 933 (78.7%)","Flow for students not in: FSM: Yes.\nFlow: (KS2: 5-) -> (GCSE: 6-) = 1393 (76.2%)","Flow for students not in: FSM: Yes.\nFlow: (KS2: 4) -> (GCSE: 6-) = 2837 (76.8%)","Flow for students not in: FSM: Yes.\nFlow: (KS2: 3-) -> (GCSE: 6-) = 772 (76.4%)","Flow for students not in: FSM: Yes.\nFlow: (GCSE: 9) -> (A_level: Maths + Further) = 5 (71.4%)","Flow for students not in: FSM: Yes.\nFlow: (GCSE: 8) -> (A_level: Maths + Further) = 14 (77.8%)","Flow for students not in: FSM: Yes.\nFlow: (GCSE: 7) -> (A_level: Maths + Further) = 11 (78.6%)","Flow for students not in: FSM: Yes.\nFlow: (GCSE: 6-) -> (A_level: Maths + Further) = 122 (72.6%)","Flow for students not in: FSM: Yes.\nFlow: (GCSE: 9) -> (A_level: Maths) = 20 (80%)","Flow for students not in: FSM: Yes.\nFlow: (GCSE: 8) -> (A_level: Maths) = 50 (78.1%)","Flow for students not in: FSM: Yes.\nFlow: (GCSE: 7) -> (A_level: Maths) = 66 (69.5%)","Flow for students not in: FSM: Yes.\nFlow: (GCSE: 6-) -> (A_level: Maths) = 520 (78.7%)","Flow for students not in: FSM: Yes.\nFlow: (GCSE: 9) -> (A_level: No Maths) = 187 (73.9%)","Flow for students not in: FSM: Yes.\nFlow: (GCSE: 8) -> (A_level: No Maths) = 499 (74.9%)","Flow for students not in: FSM: Yes.\nFlow: (GCSE: 7) -> (A_level: No Maths) = 687 (75.6%)","Flow for students not in: FSM: Yes.\nFlow: (GCSE: 6-) -> (A_level: No Maths) = 5472 (76.9%)"]},"nodes":{"name":["KS1: 3+","KS1: 2A","KS1: 2B","KS1: 2C-","KS2: 6","KS2: 5+","KS2: 5-","KS2: 4","KS2: 3-","GCSE: 9","GCSE: 8","GCSE: 7","GCSE: 6-","A_level: Maths + Further","A_level: Maths","A_level: No Maths"],"group":["my_unique_group","my_unique_group","my_unique_group","my_unique_group","my_unique_group","my_unique_group","my_unique_group","my_unique_group","my_unique_group","my_unique_group","my_unique_group","my_unique_group","my_unique_group","my_unique_group","my_unique_group","my_unique_group"],"state":["KS1: 3+\nTotal students out = 2091.\n\n # students group by FSM: Yes. \n shown as (in : not in) \n","KS1: 2A\nTotal students out = 2710.\n\n # students group by FSM: Yes. \n shown as (in : not in) \n","KS1: 2B\nTotal students out = 2724.\n\n # students group by FSM: Yes. \n shown as (in : not in) \n","KS1: 2C-\nTotal students out = 2475.\n\n # students group by FSM: Yes. \n shown as (in : not in) \n","KS2: 6\nTotal students in = 289.\nTotal students out = 289.\nContinuation = 100%.\n\n # students group by FSM: Yes. \n shown as (in : not in) \n","KS2: 5+\nTotal students in = 1494.\nTotal students out = 1494.\nContinuation = 100%.\n\n # students group by FSM: Yes. \n shown as (in : not in) \n","KS2: 5-\nTotal students in = 2290.\nTotal students out = 2290.\nContinuation = 100%.\n\n # students group by FSM: Yes. \n shown as (in : not in) \n","KS2: 4\nTotal students in = 4650.\nTotal students out = 4650.\nContinuation = 100%.\n\n # students group by FSM: Yes. \n shown as (in : not in) \n","KS2: 3-\nTotal students in = 1277.\nTotal students out = 1277.\nContinuation = 100%.\n\n # students group by FSM: Yes. \n shown as (in : not in) \n","GCSE: 9\nTotal students in = 285.\nTotal students out = 285.\nContinuation = 100%.\n\n # students group by FSM: Yes. \n shown as (in : not in) \n","GCSE: 8\nTotal students in = 748.\nTotal students out = 748.\nContinuation = 100%.\n\n # students group by FSM: Yes. \n shown as (in : not in) \n","GCSE: 7\nTotal students in = 1018.\nTotal students out = 1018.\nContinuation = 100%.\n\n # students group by FSM: Yes. \n shown as (in : not in) \n","GCSE: 6-\nTotal students in = 7949.\nTotal students out = 7949.\nContinuation = 100%.\n\n # students group by FSM: Yes. \n shown as (in : not in) \n","A_level: Maths + Further\nTotal students in = 207.\n\n # students group by FSM: Yes. \n shown as (in : not in) \n","A_level: Maths\nTotal students in = 845.\n\n # students group by FSM: Yes. \n shown as (in : not in) \n","A_level: No Maths\nTotal students in = 8948.\n\n # students group by FSM: Yes. \n shown as (in : not in) \n"]},"options":{"NodeID":"names","NodeGroup":"group","LinkGroup":"group","colourScale":"d3.scaleOrdinal() .domain([\"type_a\", \"type_b\", \"my_unique_group\"]) .range([\"red\", \"gray\", \"antiquewhite\"])","fontSize":7,"fontFamily":null,"nodeWidth":15,"nodePadding":10,"units":"","margin":{"top":null,"right":null,"bottom":null,"left":null},"iterations":0,"sinksRight":false}},"evals":[],"jsHooks":{"render":[{"code":"\n            function(el, x) {\n                d3.selectAll(\".node\").select(\"title foreignObject body pre\")\n                .text(function(d) { return d.state; });\n            }\n            ","data":null},{"code":"\n  function(el, x) {\n  d3.selectAll(\".link\").select(\"title foreignObject body pre\")\n  .text(function(d) { return d.name; });\n  }\n  ","data":null}]}}</script><div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co"># Only those that got a grade 9 at GCSE.</span></span>
<span><span class="va">p</span> <span class="op">=</span> <span class="fu"><a href="../reference/sankey_trace.html">sankey_trace</a></span><span class="op">(</span>pathways <span class="op">=</span> <span class="va">pathways</span>, flow_columns <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span><span class="op">:</span><span class="fl">5</span><span class="op">)</span>, split_by <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'GCSE: 9'</span> <span class="op">)</span><span class="op">)</span></span>
<span><span class="va">p</span></span></code></pre></div>
<div class="sankeyNetwork html-widget html-fill-item" id="htmlwidget-3f27c09be0c60bb52829" style="width:960px;height:384px;"></div>
<script type="application/json" data-for="htmlwidget-3f27c09be0c60bb52829">{"x":{"links":{"source":[2,3,0,1,2,3,0,1,2,3,0,1,2,3,0,1,2,3,4,5,6,7,8,9,9,9,0,1,2,3,0,1,2,3,0,1,2,3,0,1,2,3,0,1,2,3,4,5,6,7,8,4,5,6,7,8,4,5,6,7,8,10,11,12,10,11,12,10,11,12],"target":[4,4,5,5,5,5,6,6,6,6,7,7,7,7,8,8,8,8,9,9,9,9,9,13,14,15,4,4,4,4,5,5,5,5,6,6,6,6,7,7,7,7,8,8,8,8,10,10,10,10,10,11,11,11,11,11,12,12,12,12,12,13,13,13,14,14,14,15,15,15],"value":["3","4","5","10","12","4","9","23","9","23","39","43","36","31","6","9","11","8","7","31","64","149","34","7","25","253","58","83","71","70","312","405","397","349","451","585","652","538","953","1199","1205","1144","258","353","328","304","20","103","170","362","93","29","175","228","447","139","233","1185","1828","3692","1011","18","14","168","64","95","661","666","909","7120"],"group":["type_a","type_a","type_a","type_a","type_a","type_a","type_a","type_a","type_a","type_a","type_a","type_a","type_a","type_a","type_a","type_a","type_a","type_a","type_a","type_a","type_a","type_a","type_a","type_a","type_a","type_a","type_b","type_b","type_b","type_b","type_b","type_b","type_b","type_b","type_b","type_b","type_b","type_b","type_b","type_b","type_b","type_b","type_b","type_b","type_b","type_b","type_b","type_b","type_b","type_b","type_b","type_b","type_b","type_b","type_b","type_b","type_b","type_b","type_b","type_b","type_b","type_b","type_b","type_b","type_b","type_b","type_b","type_b","type_b","type_b"],"name":["Flow for students in: GCSE: 9.\nFlow: (KS1: 2B) -> (KS2: 6) = 3 (4.1%)","Flow for students in: GCSE: 9.\nFlow: (KS1: 2C-) -> (KS2: 6) = 4 (5.4%)","Flow for students in: GCSE: 9.\nFlow: (KS1: 3+) -> (KS2: 5+) = 5 (1.6%)","Flow for students in: GCSE: 9.\nFlow: (KS1: 2A) -> (KS2: 5+) = 10 (2.4%)","Flow for students in: GCSE: 9.\nFlow: (KS1: 2B) -> (KS2: 5+) = 12 (2.9%)","Flow for students in: GCSE: 9.\nFlow: (KS1: 2C-) -> (KS2: 5+) = 4 (1.1%)","Flow for students in: GCSE: 9.\nFlow: (KS1: 3+) -> (KS2: 5-) = 9 (2%)","Flow for students in: GCSE: 9.\nFlow: (KS1: 2A) -> (KS2: 5-) = 23 (3.8%)","Flow for students in: GCSE: 9.\nFlow: (KS1: 2B) -> (KS2: 5-) = 9 (1.4%)","Flow for students in: GCSE: 9.\nFlow: (KS1: 2C-) -> (KS2: 5-) = 23 (4.1%)","Flow for students in: GCSE: 9.\nFlow: (KS1: 3+) -> (KS2: 4) = 39 (3.9%)","Flow for students in: GCSE: 9.\nFlow: (KS1: 2A) -> (KS2: 4) = 43 (3.5%)","Flow for students in: GCSE: 9.\nFlow: (KS1: 2B) -> (KS2: 4) = 36 (2.9%)","Flow for students in: GCSE: 9.\nFlow: (KS1: 2C-) -> (KS2: 4) = 31 (2.6%)","Flow for students in: GCSE: 9.\nFlow: (KS1: 3+) -> (KS2: 3-) = 6 (2.3%)","Flow for students in: GCSE: 9.\nFlow: (KS1: 2A) -> (KS2: 3-) = 9 (2.5%)","Flow for students in: GCSE: 9.\nFlow: (KS1: 2B) -> (KS2: 3-) = 11 (3.2%)","Flow for students in: GCSE: 9.\nFlow: (KS1: 2C-) -> (KS2: 3-) = 8 (2.6%)","Flow for students in: GCSE: 9.\nFlow: (KS2: 6) -> (GCSE: 9) = 7 (100%)","Flow for students in: GCSE: 9.\nFlow: (KS2: 5+) -> (GCSE: 9) = 31 (100%)","Flow for students in: GCSE: 9.\nFlow: (KS2: 5-) -> (GCSE: 9) = 64 (100%)","Flow for students in: GCSE: 9.\nFlow: (KS2: 4) -> (GCSE: 9) = 149 (100%)","Flow for students in: GCSE: 9.\nFlow: (KS2: 3-) -> (GCSE: 9) = 34 (100%)","Flow for students in: GCSE: 9.\nFlow: (GCSE: 9) -> (A_level: Maths + Further) = 7 (100%)","Flow for students in: GCSE: 9.\nFlow: (GCSE: 9) -> (A_level: Maths) = 25 (100%)","Flow for students in: GCSE: 9.\nFlow: (GCSE: 9) -> (A_level: No Maths) = 253 (100%)","Flow for students not in: GCSE: 9.\nFlow: (KS1: 3+) -> (KS2: 6) = 58 (100%)","Flow for students not in: GCSE: 9.\nFlow: (KS1: 2A) -> (KS2: 6) = 83 (100%)","Flow for students not in: GCSE: 9.\nFlow: (KS1: 2B) -> (KS2: 6) = 71 (95.9%)","Flow for students not in: GCSE: 9.\nFlow: (KS1: 2C-) -> (KS2: 6) = 70 (94.6%)","Flow for students not in: GCSE: 9.\nFlow: (KS1: 3+) -> (KS2: 5+) = 312 (98.4%)","Flow for students not in: GCSE: 9.\nFlow: (KS1: 2A) -> (KS2: 5+) = 405 (97.6%)","Flow for students not in: GCSE: 9.\nFlow: (KS1: 2B) -> (KS2: 5+) = 397 (97.1%)","Flow for students not in: GCSE: 9.\nFlow: (KS1: 2C-) -> (KS2: 5+) = 349 (98.9%)","Flow for students not in: GCSE: 9.\nFlow: (KS1: 3+) -> (KS2: 5-) = 451 (98%)","Flow for students not in: GCSE: 9.\nFlow: (KS1: 2A) -> (KS2: 5-) = 585 (96.2%)","Flow for students not in: GCSE: 9.\nFlow: (KS1: 2B) -> (KS2: 5-) = 652 (98.6%)","Flow for students not in: GCSE: 9.\nFlow: (KS1: 2C-) -> (KS2: 5-) = 538 (95.9%)","Flow for students not in: GCSE: 9.\nFlow: (KS1: 3+) -> (KS2: 4) = 953 (96.1%)","Flow for students not in: GCSE: 9.\nFlow: (KS1: 2A) -> (KS2: 4) = 1199 (96.5%)","Flow for students not in: GCSE: 9.\nFlow: (KS1: 2B) -> (KS2: 4) = 1205 (97.1%)","Flow for students not in: GCSE: 9.\nFlow: (KS1: 2C-) -> (KS2: 4) = 1144 (97.4%)","Flow for students not in: GCSE: 9.\nFlow: (KS1: 3+) -> (KS2: 3-) = 258 (97.7%)","Flow for students not in: GCSE: 9.\nFlow: (KS1: 2A) -> (KS2: 3-) = 353 (97.5%)","Flow for students not in: GCSE: 9.\nFlow: (KS1: 2B) -> (KS2: 3-) = 328 (96.8%)","Flow for students not in: GCSE: 9.\nFlow: (KS1: 2C-) -> (KS2: 3-) = 304 (97.4%)","Flow for students not in: GCSE: 9.\nFlow: (KS2: 6) -> (GCSE: 8) = 20 (100%)","Flow for students not in: GCSE: 9.\nFlow: (KS2: 5+) -> (GCSE: 8) = 103 (100%)","Flow for students not in: GCSE: 9.\nFlow: (KS2: 5-) -> (GCSE: 8) = 170 (100%)","Flow for students not in: GCSE: 9.\nFlow: (KS2: 4) -> (GCSE: 8) = 362 (100%)","Flow for students not in: GCSE: 9.\nFlow: (KS2: 3-) -> (GCSE: 8) = 93 (100%)","Flow for students not in: GCSE: 9.\nFlow: (KS2: 6) -> (GCSE: 7) = 29 (100%)","Flow for students not in: GCSE: 9.\nFlow: (KS2: 5+) -> (GCSE: 7) = 175 (100%)","Flow for students not in: GCSE: 9.\nFlow: (KS2: 5-) -> (GCSE: 7) = 228 (100%)","Flow for students not in: GCSE: 9.\nFlow: (KS2: 4) -> (GCSE: 7) = 447 (100%)","Flow for students not in: GCSE: 9.\nFlow: (KS2: 3-) -> (GCSE: 7) = 139 (100%)","Flow for students not in: GCSE: 9.\nFlow: (KS2: 6) -> (GCSE: 6-) = 233 (100%)","Flow for students not in: GCSE: 9.\nFlow: (KS2: 5+) -> (GCSE: 6-) = 1185 (100%)","Flow for students not in: GCSE: 9.\nFlow: (KS2: 5-) -> (GCSE: 6-) = 1828 (100%)","Flow for students not in: GCSE: 9.\nFlow: (KS2: 4) -> (GCSE: 6-) = 3692 (100%)","Flow for students not in: GCSE: 9.\nFlow: (KS2: 3-) -> (GCSE: 6-) = 1011 (100%)","Flow for students not in: GCSE: 9.\nFlow: (GCSE: 8) -> (A_level: Maths + Further) = 18 (100%)","Flow for students not in: GCSE: 9.\nFlow: (GCSE: 7) -> (A_level: Maths + Further) = 14 (100%)","Flow for students not in: GCSE: 9.\nFlow: (GCSE: 6-) -> (A_level: Maths + Further) = 168 (100%)","Flow for students not in: GCSE: 9.\nFlow: (GCSE: 8) -> (A_level: Maths) = 64 (100%)","Flow for students not in: GCSE: 9.\nFlow: (GCSE: 7) -> (A_level: Maths) = 95 (100%)","Flow for students not in: GCSE: 9.\nFlow: (GCSE: 6-) -> (A_level: Maths) = 661 (100%)","Flow for students not in: GCSE: 9.\nFlow: (GCSE: 8) -> (A_level: No Maths) = 666 (100%)","Flow for students not in: GCSE: 9.\nFlow: (GCSE: 7) -> (A_level: No Maths) = 909 (100%)","Flow for students not in: GCSE: 9.\nFlow: (GCSE: 6-) -> (A_level: No Maths) = 7120 (100%)"]},"nodes":{"name":["KS1: 3+","KS1: 2A","KS1: 2B","KS1: 2C-","KS2: 6","KS2: 5+","KS2: 5-","KS2: 4","KS2: 3-","GCSE: 9","GCSE: 8","GCSE: 7","GCSE: 6-","A_level: Maths + Further","A_level: Maths","A_level: No Maths"],"group":["my_unique_group","my_unique_group","my_unique_group","my_unique_group","my_unique_group","my_unique_group","my_unique_group","my_unique_group","my_unique_group","my_unique_group","my_unique_group","my_unique_group","my_unique_group","my_unique_group","my_unique_group","my_unique_group"],"state":["KS1: 3+\nTotal students out = 2091.\n\n # students group by GCSE: 9. \n shown as (in : not in) \n","KS1: 2A\nTotal students out = 2710.\n\n # students group by GCSE: 9. \n shown as (in : not in) \n","KS1: 2B\nTotal students out = 2724.\n\n # students group by GCSE: 9. \n shown as (in : not in) \n","KS1: 2C-\nTotal students out = 2475.\n\n # students group by GCSE: 9. \n shown as (in : not in) \n","KS2: 6\nTotal students in = 289.\nTotal students out = 289.\nContinuation = 100%.\n\n # students group by GCSE: 9. \n shown as (in : not in) \n","KS2: 5+\nTotal students in = 1494.\nTotal students out = 1494.\nContinuation = 100%.\n\n # students group by GCSE: 9. \n shown as (in : not in) \n","KS2: 5-\nTotal students in = 2290.\nTotal students out = 2290.\nContinuation = 100%.\n\n # students group by GCSE: 9. \n shown as (in : not in) \n","KS2: 4\nTotal students in = 4650.\nTotal students out = 4650.\nContinuation = 100%.\n\n # students group by GCSE: 9. \n shown as (in : not in) \n","KS2: 3-\nTotal students in = 1277.\nTotal students out = 1277.\nContinuation = 100%.\n\n # students group by GCSE: 9. \n shown as (in : not in) \n","GCSE: 9\nTotal students in = 285.\nTotal students out = 285.\nContinuation = 100%.\n\n # students group by GCSE: 9. \n shown as (in : not in) \n","GCSE: 8\nTotal students in = 748.\nTotal students out = 748.\nContinuation = 100%.\n\n # students group by GCSE: 9. \n shown as (in : not in) \n","GCSE: 7\nTotal students in = 1018.\nTotal students out = 1018.\nContinuation = 100%.\n\n # students group by GCSE: 9. \n shown as (in : not in) \n","GCSE: 6-\nTotal students in = 7949.\nTotal students out = 7949.\nContinuation = 100%.\n\n # students group by GCSE: 9. \n shown as (in : not in) \n","A_level: Maths + Further\nTotal students in = 207.\n\n # students group by GCSE: 9. \n shown as (in : not in) \n","A_level: Maths\nTotal students in = 845.\n\n # students group by GCSE: 9. \n shown as (in : not in) \n","A_level: No Maths\nTotal students in = 8948.\n\n # students group by GCSE: 9. \n shown as (in : not in) \n"]},"options":{"NodeID":"names","NodeGroup":"group","LinkGroup":"group","colourScale":"d3.scaleOrdinal() .domain([\"type_a\", \"type_b\", \"my_unique_group\"]) .range([\"red\", \"gray\", \"antiquewhite\"])","fontSize":7,"fontFamily":null,"nodeWidth":15,"nodePadding":10,"units":"","margin":{"top":null,"right":null,"bottom":null,"left":null},"iterations":0,"sinksRight":false}},"evals":[],"jsHooks":{"render":[{"code":"\n            function(el, x) {\n                d3.selectAll(\".node\").select(\"title foreignObject body pre\")\n                .text(function(d) { return d.state; });\n            }\n            ","data":null},{"code":"\n  function(el, x) {\n  d3.selectAll(\".link\").select(\"title foreignObject body pre\")\n  .text(function(d) { return d.name; });\n  }\n  ","data":null}]}}</script>
</div>
<div class="section level3">
<h3 id="customisation-visualisation-options">Customisation visualisation options<a class="anchor" aria-label="anchor" href="#customisation-visualisation-options"></a>
</h3>
<p>In this section we show how to use functions to alter the
visualisation of the sankey diagrams.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">p</span> <span class="op">=</span> <span class="fu"><a href="../reference/sankey_filtered.html">sankey_filtered</a></span><span class="op">(</span>pathways <span class="op">=</span> <span class="va">pathways</span>, flow_columns <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span><span class="op">:</span><span class="fl">5</span><span class="op">)</span>, filters <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'GCSE: 9'</span>, <span class="st">'GCSE: 8'</span><span class="op">)</span>, union <span class="op">=</span> <span class="cn">T</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## Add header to columns</span></span>
<span><span class="va">p</span> <span class="op">|&gt;</span> <span class="fu"><a href="../reference/add_column_names.html">add_column_names</a></span><span class="op">(</span>column_titles <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'KS1'</span>, <span class="st">'KS2'</span>, <span class="st">'GCSE'</span>, <span class="st">'A Level'</span><span class="op">)</span>,fontSize <span class="op">=</span> <span class="fl">14</span><span class="op">)</span></span></code></pre></div>
<div class="sankeyNetwork html-widget html-fill-item" id="htmlwidget-416566eb193bf50d04e6" style="width:700px;height:432.632880098888px;"></div>
<script type="application/json" data-for="htmlwidget-416566eb193bf50d04e6">{"x":{"links":{"source":[0,1,2,3,0,1,2,3,0,1,2,3,0,1,2,3,0,1,2,3,4,5,6,7,8,4,5,6,7,8,9,10,9,10,9,10],"target":[4,4,4,4,5,5,5,5,6,6,6,6,7,7,7,7,8,8,8,8,9,9,9,9,9,10,10,10,10,10,11,11,12,12,13,13],"value":["4","2","11","10","20","44","43","27","45","70","58","61","114","134","132","131","27","37","38","25","7","31","64","149","34","20","103","170","362","93","7","18","25","64","253","666"],"name":["Flow: (KS1: 3+) -> (KS2: 6) = 4\n\n As percent of students leaving KS1: 3+ = 1.9%.\n\n As percent of students entering KS2: 6 = 14.8%.","Flow: (KS1: 2A) -> (KS2: 6) = 2\n\n As percent of students leaving KS1: 2A = 0.7%.\n\n As percent of students entering KS2: 6 = 7.4%.","Flow: (KS1: 2B) -> (KS2: 6) = 11\n\n As percent of students leaving KS1: 2B = 3.9%.\n\n As percent of students entering KS2: 6 = 40.7%.","Flow: (KS1: 2C-) -> (KS2: 6) = 10\n\n As percent of students leaving KS1: 2C- = 3.9%.\n\n As percent of students entering KS2: 6 = 37%.","Flow: (KS1: 3+) -> (KS2: 5+) = 20\n\n As percent of students leaving KS1: 3+ = 9.5%.\n\n As percent of students entering KS2: 5+ = 14.9%.","Flow: (KS1: 2A) -> (KS2: 5+) = 44\n\n As percent of students leaving KS1: 2A = 15.3%.\n\n As percent of students entering KS2: 5+ = 32.8%.","Flow: (KS1: 2B) -> (KS2: 5+) = 43\n\n As percent of students leaving KS1: 2B = 15.2%.\n\n As percent of students entering KS2: 5+ = 32.1%.","Flow: (KS1: 2C-) -> (KS2: 5+) = 27\n\n As percent of students leaving KS1: 2C- = 10.6%.\n\n As percent of students entering KS2: 5+ = 20.1%.","Flow: (KS1: 3+) -> (KS2: 5-) = 45\n\n As percent of students leaving KS1: 3+ = 21.4%.\n\n As percent of students entering KS2: 5- = 19.2%.","Flow: (KS1: 2A) -> (KS2: 5-) = 70\n\n As percent of students leaving KS1: 2A = 24.4%.\n\n As percent of students entering KS2: 5- = 29.9%.","Flow: (KS1: 2B) -> (KS2: 5-) = 58\n\n As percent of students leaving KS1: 2B = 20.6%.\n\n As percent of students entering KS2: 5- = 24.8%.","Flow: (KS1: 2C-) -> (KS2: 5-) = 61\n\n As percent of students leaving KS1: 2C- = 24%.\n\n As percent of students entering KS2: 5- = 26.1%.","Flow: (KS1: 3+) -> (KS2: 4) = 114\n\n As percent of students leaving KS1: 3+ = 54.3%.\n\n As percent of students entering KS2: 4 = 22.3%.","Flow: (KS1: 2A) -> (KS2: 4) = 134\n\n As percent of students leaving KS1: 2A = 46.7%.\n\n As percent of students entering KS2: 4 = 26.2%.","Flow: (KS1: 2B) -> (KS2: 4) = 132\n\n As percent of students leaving KS1: 2B = 46.8%.\n\n As percent of students entering KS2: 4 = 25.8%.","Flow: (KS1: 2C-) -> (KS2: 4) = 131\n\n As percent of students leaving KS1: 2C- = 51.6%.\n\n As percent of students entering KS2: 4 = 25.6%.","Flow: (KS1: 3+) -> (KS2: 3-) = 27\n\n As percent of students leaving KS1: 3+ = 12.9%.\n\n As percent of students entering KS2: 3- = 21.3%.","Flow: (KS1: 2A) -> (KS2: 3-) = 37\n\n As percent of students leaving KS1: 2A = 12.9%.\n\n As percent of students entering KS2: 3- = 29.1%.","Flow: (KS1: 2B) -> (KS2: 3-) = 38\n\n As percent of students leaving KS1: 2B = 13.5%.\n\n As percent of students entering KS2: 3- = 29.9%.","Flow: (KS1: 2C-) -> (KS2: 3-) = 25\n\n As percent of students leaving KS1: 2C- = 9.8%.\n\n As percent of students entering KS2: 3- = 19.7%.","Flow: (KS2: 6) -> (GCSE: 9) = 7\n\n As percent of students leaving KS2: 6 = 25.9%.\n\n As percent of students entering GCSE: 9 = 2.5%.","Flow: (KS2: 5+) -> (GCSE: 9) = 31\n\n As percent of students leaving KS2: 5+ = 23.1%.\n\n As percent of students entering GCSE: 9 = 10.9%.","Flow: (KS2: 5-) -> (GCSE: 9) = 64\n\n As percent of students leaving KS2: 5- = 27.4%.\n\n As percent of students entering GCSE: 9 = 22.5%.","Flow: (KS2: 4) -> (GCSE: 9) = 149\n\n As percent of students leaving KS2: 4 = 29.2%.\n\n As percent of students entering GCSE: 9 = 52.3%.","Flow: (KS2: 3-) -> (GCSE: 9) = 34\n\n As percent of students leaving KS2: 3- = 26.8%.\n\n As percent of students entering GCSE: 9 = 11.9%.","Flow: (KS2: 6) -> (GCSE: 8) = 20\n\n As percent of students leaving KS2: 6 = 74.1%.\n\n As percent of students entering GCSE: 8 = 2.7%.","Flow: (KS2: 5+) -> (GCSE: 8) = 103\n\n As percent of students leaving KS2: 5+ = 76.9%.\n\n As percent of students entering GCSE: 8 = 13.8%.","Flow: (KS2: 5-) -> (GCSE: 8) = 170\n\n As percent of students leaving KS2: 5- = 72.6%.\n\n As percent of students entering GCSE: 8 = 22.7%.","Flow: (KS2: 4) -> (GCSE: 8) = 362\n\n As percent of students leaving KS2: 4 = 70.8%.\n\n As percent of students entering GCSE: 8 = 48.4%.","Flow: (KS2: 3-) -> (GCSE: 8) = 93\n\n As percent of students leaving KS2: 3- = 73.2%.\n\n As percent of students entering GCSE: 8 = 12.4%.","Flow: (GCSE: 9) -> (A_level: Maths + Further) = 7\n\n As percent of students leaving GCSE: 9 = 2.5%.\n\n As percent of students entering A_level: Maths + Further = 28%.","Flow: (GCSE: 8) -> (A_level: Maths + Further) = 18\n\n As percent of students leaving GCSE: 8 = 2.4%.\n\n As percent of students entering A_level: Maths + Further = 72%.","Flow: (GCSE: 9) -> (A_level: Maths) = 25\n\n As percent of students leaving GCSE: 9 = 8.8%.\n\n As percent of students entering A_level: Maths = 28.1%.","Flow: (GCSE: 8) -> (A_level: Maths) = 64\n\n As percent of students leaving GCSE: 8 = 8.6%.\n\n As percent of students entering A_level: Maths = 71.9%.","Flow: (GCSE: 9) -> (A_level: No Maths) = 253\n\n As percent of students leaving GCSE: 9 = 88.8%.\n\n As percent of students entering A_level: No Maths = 27.5%.","Flow: (GCSE: 8) -> (A_level: No Maths) = 666\n\n As percent of students leaving GCSE: 8 = 89%.\n\n As percent of students entering A_level: No Maths = 72.5%."]},"nodes":{"name":["KS1: 3+","KS1: 2A","KS1: 2B","KS1: 2C-","KS2: 6","KS2: 5+","KS2: 5-","KS2: 4","KS2: 3-","GCSE: 9","GCSE: 8","A_level: Maths + Further","A_level: Maths","A_level: No Maths"],"group":["KS1: 3+","KS1: 2A","KS1: 2B","KS1: 2C-","KS2: 6","KS2: 5+","KS2: 5-","KS2: 4","KS2: 3-","GCSE: 9","GCSE: 8","A_level: Maths + Further","A_level: Maths","A_level: No Maths"],"state":["KS1: 3+\nTotal students out = 210.\n\nAs % of KS1 stage.\n\tOut = 20.3%.","KS1: 2A\nTotal students out = 287.\n\nAs % of KS1 stage.\n\tOut = 27.8%.","KS1: 2B\nTotal students out = 282.\n\nAs % of KS1 stage.\n\tOut = 27.3%.","KS1: 2C-\nTotal students out = 254.\n\nAs % of KS1 stage.\n\tOut = 24.6%.","KS2: 6\nTotal students in = 27.\nTotal students out = 27.\nContinuation = 100%.\n\nAs % of KS2 stage.\n\tIn = 2.6%.\n\tOut = 2.6%.","KS2: 5+\nTotal students in = 134.\nTotal students out = 134.\nContinuation = 100%.\n\nAs % of KS2 stage.\n\tIn = 13%.\n\tOut = 13%.","KS2: 5-\nTotal students in = 234.\nTotal students out = 234.\nContinuation = 100%.\n\nAs % of KS2 stage.\n\tIn = 22.7%.\n\tOut = 22.7%.","KS2: 4\nTotal students in = 511.\nTotal students out = 511.\nContinuation = 100%.\n\nAs % of KS2 stage.\n\tIn = 49.5%.\n\tOut = 49.5%.","KS2: 3-\nTotal students in = 127.\nTotal students out = 127.\nContinuation = 100%.\n\nAs % of KS2 stage.\n\tIn = 12.3%.\n\tOut = 12.3%.","GCSE: 9\nTotal students in = 285.\nTotal students out = 285.\nContinuation = 100%.\n\nAs % of GCSE stage.\n\tIn = 27.6%.\n\tOut = 27.6%.","GCSE: 8\nTotal students in = 748.\nTotal students out = 748.\nContinuation = 100%.\n\nAs % of GCSE stage.\n\tIn = 72.4%.\n\tOut = 72.4%.","A_level: Maths + Further\nTotal students in = 25.\n\nAs % of A_level stage.\n\tIn = 2.4%.","A_level: Maths\nTotal students in = 89.\n\nAs % of A_level stage.\n\tIn = 8.6%.","A_level: No Maths\nTotal students in = 919.\n\nAs % of A_level stage.\n\tIn = 89%."]},"options":{"NodeID":"names","NodeGroup":"names","LinkGroup":null,"colourScale":"d3.scaleOrdinal(d3.schemeCategory20);","fontSize":7,"fontFamily":null,"nodeWidth":15,"nodePadding":10,"units":"","margin":{"top":null,"right":null,"bottom":null,"left":null},"iterations":0,"sinksRight":false}},"evals":[],"jsHooks":{"render":[{"code":"\n            function(el, x) {\n                d3.selectAll(\".node\").select(\"title foreignObject body pre\")\n                .text(function(d) { return d.state; });\n            }\n            ","data":null},{"code":"\n  function(el, x) {\n  d3.selectAll(\".link\").select(\"title foreignObject body pre\")\n  .text(function(d) { return d.name; });\n  }\n  ","data":null},{"code":"\n  function(el) {\n    var cols_x = this.sankey.nodes().map(d => d.x).filter((v, i, a) => a.indexOf(v) === i).sort(function(a, b){return a - b});\n    var labels = [\"KS1\", \"KS2\", \"GCSE\", \"A Level\"];\n    cols_x.forEach((d, i) => {\n      d3.select(el).select(\"svg\")\n        .append(\"text\")\n        .attr(\"x\", d)\n        .attr(\"y\", 12)\n        .text(labels[i])\n        .style(\"font-size\", \"14px\")\n        .style(\"font-family\", \"\");\n    })\n  }\n","data":null}]}}</script><div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co"># Update the node names.</span></span>
<span><span class="co"># p |&gt; get_nodes() # Can be run to get the node order in the diagram to change.</span></span>
<span><span class="va">p</span> <span class="op">|&gt;</span> <span class="fu"><a href="../reference/add_column_names.html">update_node_title</a></span><span class="op">(</span>titles <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Level 3+"</span>, <span class="st">"Level 2A"</span>, <span class="st">"Level 2B"</span>, <span class="st">"Level 2C-"</span>,</span>
<span>                       <span class="st">"Level 6"</span>, <span class="st">"Level 5+"</span>, <span class="st">"Level 5-"</span>, <span class="st">"Level 4"</span>, <span class="st">"Level 3-"</span>,</span>
<span>                       <span class="st">"Grade 8"</span>,<span class="st">"Grade 9"</span>,</span>
<span>                       <span class="st">"Maths + Further"</span>, <span class="st">"Maths"</span>, <span class="st">"No Maths"</span> <span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="sankeyNetwork html-widget html-fill-item" id="htmlwidget-72cbf064100ce560a04c" style="width:700px;height:432.632880098888px;"></div>
<script type="application/json" data-for="htmlwidget-72cbf064100ce560a04c">{"x":{"links":{"source":[0,1,2,3,0,1,2,3,0,1,2,3,0,1,2,3,0,1,2,3,4,5,6,7,8,4,5,6,7,8,9,10,9,10,9,10],"target":[4,4,4,4,5,5,5,5,6,6,6,6,7,7,7,7,8,8,8,8,9,9,9,9,9,10,10,10,10,10,11,11,12,12,13,13],"value":["4","2","11","10","20","44","43","27","45","70","58","61","114","134","132","131","27","37","38","25","7","31","64","149","34","20","103","170","362","93","7","18","25","64","253","666"],"name":["Flow: (KS1: 3+) -> (KS2: 6) = 4\n\n As percent of students leaving KS1: 3+ = 1.9%.\n\n As percent of students entering KS2: 6 = 14.8%.","Flow: (KS1: 2A) -> (KS2: 6) = 2\n\n As percent of students leaving KS1: 2A = 0.7%.\n\n As percent of students entering KS2: 6 = 7.4%.","Flow: (KS1: 2B) -> (KS2: 6) = 11\n\n As percent of students leaving KS1: 2B = 3.9%.\n\n As percent of students entering KS2: 6 = 40.7%.","Flow: (KS1: 2C-) -> (KS2: 6) = 10\n\n As percent of students leaving KS1: 2C- = 3.9%.\n\n As percent of students entering KS2: 6 = 37%.","Flow: (KS1: 3+) -> (KS2: 5+) = 20\n\n As percent of students leaving KS1: 3+ = 9.5%.\n\n As percent of students entering KS2: 5+ = 14.9%.","Flow: (KS1: 2A) -> (KS2: 5+) = 44\n\n As percent of students leaving KS1: 2A = 15.3%.\n\n As percent of students entering KS2: 5+ = 32.8%.","Flow: (KS1: 2B) -> (KS2: 5+) = 43\n\n As percent of students leaving KS1: 2B = 15.2%.\n\n As percent of students entering KS2: 5+ = 32.1%.","Flow: (KS1: 2C-) -> (KS2: 5+) = 27\n\n As percent of students leaving KS1: 2C- = 10.6%.\n\n As percent of students entering KS2: 5+ = 20.1%.","Flow: (KS1: 3+) -> (KS2: 5-) = 45\n\n As percent of students leaving KS1: 3+ = 21.4%.\n\n As percent of students entering KS2: 5- = 19.2%.","Flow: (KS1: 2A) -> (KS2: 5-) = 70\n\n As percent of students leaving KS1: 2A = 24.4%.\n\n As percent of students entering KS2: 5- = 29.9%.","Flow: (KS1: 2B) -> (KS2: 5-) = 58\n\n As percent of students leaving KS1: 2B = 20.6%.\n\n As percent of students entering KS2: 5- = 24.8%.","Flow: (KS1: 2C-) -> (KS2: 5-) = 61\n\n As percent of students leaving KS1: 2C- = 24%.\n\n As percent of students entering KS2: 5- = 26.1%.","Flow: (KS1: 3+) -> (KS2: 4) = 114\n\n As percent of students leaving KS1: 3+ = 54.3%.\n\n As percent of students entering KS2: 4 = 22.3%.","Flow: (KS1: 2A) -> (KS2: 4) = 134\n\n As percent of students leaving KS1: 2A = 46.7%.\n\n As percent of students entering KS2: 4 = 26.2%.","Flow: (KS1: 2B) -> (KS2: 4) = 132\n\n As percent of students leaving KS1: 2B = 46.8%.\n\n As percent of students entering KS2: 4 = 25.8%.","Flow: (KS1: 2C-) -> (KS2: 4) = 131\n\n As percent of students leaving KS1: 2C- = 51.6%.\n\n As percent of students entering KS2: 4 = 25.6%.","Flow: (KS1: 3+) -> (KS2: 3-) = 27\n\n As percent of students leaving KS1: 3+ = 12.9%.\n\n As percent of students entering KS2: 3- = 21.3%.","Flow: (KS1: 2A) -> (KS2: 3-) = 37\n\n As percent of students leaving KS1: 2A = 12.9%.\n\n As percent of students entering KS2: 3- = 29.1%.","Flow: (KS1: 2B) -> (KS2: 3-) = 38\n\n As percent of students leaving KS1: 2B = 13.5%.\n\n As percent of students entering KS2: 3- = 29.9%.","Flow: (KS1: 2C-) -> (KS2: 3-) = 25\n\n As percent of students leaving KS1: 2C- = 9.8%.\n\n As percent of students entering KS2: 3- = 19.7%.","Flow: (KS2: 6) -> (GCSE: 9) = 7\n\n As percent of students leaving KS2: 6 = 25.9%.\n\n As percent of students entering GCSE: 9 = 2.5%.","Flow: (KS2: 5+) -> (GCSE: 9) = 31\n\n As percent of students leaving KS2: 5+ = 23.1%.\n\n As percent of students entering GCSE: 9 = 10.9%.","Flow: (KS2: 5-) -> (GCSE: 9) = 64\n\n As percent of students leaving KS2: 5- = 27.4%.\n\n As percent of students entering GCSE: 9 = 22.5%.","Flow: (KS2: 4) -> (GCSE: 9) = 149\n\n As percent of students leaving KS2: 4 = 29.2%.\n\n As percent of students entering GCSE: 9 = 52.3%.","Flow: (KS2: 3-) -> (GCSE: 9) = 34\n\n As percent of students leaving KS2: 3- = 26.8%.\n\n As percent of students entering GCSE: 9 = 11.9%.","Flow: (KS2: 6) -> (GCSE: 8) = 20\n\n As percent of students leaving KS2: 6 = 74.1%.\n\n As percent of students entering GCSE: 8 = 2.7%.","Flow: (KS2: 5+) -> (GCSE: 8) = 103\n\n As percent of students leaving KS2: 5+ = 76.9%.\n\n As percent of students entering GCSE: 8 = 13.8%.","Flow: (KS2: 5-) -> (GCSE: 8) = 170\n\n As percent of students leaving KS2: 5- = 72.6%.\n\n As percent of students entering GCSE: 8 = 22.7%.","Flow: (KS2: 4) -> (GCSE: 8) = 362\n\n As percent of students leaving KS2: 4 = 70.8%.\n\n As percent of students entering GCSE: 8 = 48.4%.","Flow: (KS2: 3-) -> (GCSE: 8) = 93\n\n As percent of students leaving KS2: 3- = 73.2%.\n\n As percent of students entering GCSE: 8 = 12.4%.","Flow: (GCSE: 9) -> (A_level: Maths + Further) = 7\n\n As percent of students leaving GCSE: 9 = 2.5%.\n\n As percent of students entering A_level: Maths + Further = 28%.","Flow: (GCSE: 8) -> (A_level: Maths + Further) = 18\n\n As percent of students leaving GCSE: 8 = 2.4%.\n\n As percent of students entering A_level: Maths + Further = 72%.","Flow: (GCSE: 9) -> (A_level: Maths) = 25\n\n As percent of students leaving GCSE: 9 = 8.8%.\n\n As percent of students entering A_level: Maths = 28.1%.","Flow: (GCSE: 8) -> (A_level: Maths) = 64\n\n As percent of students leaving GCSE: 8 = 8.6%.\n\n As percent of students entering A_level: Maths = 71.9%.","Flow: (GCSE: 9) -> (A_level: No Maths) = 253\n\n As percent of students leaving GCSE: 9 = 88.8%.\n\n As percent of students entering A_level: No Maths = 27.5%.","Flow: (GCSE: 8) -> (A_level: No Maths) = 666\n\n As percent of students leaving GCSE: 8 = 89%.\n\n As percent of students entering A_level: No Maths = 72.5%."]},"nodes":{"name":["Level 3+","Level 2A","Level 2B","Level 2C-","Level 6","Level 5+","Level 5-","Level 4","Level 3-","Grade 8","Grade 9","Maths + Further","Maths","No Maths"],"group":["KS1: 3+","KS1: 2A","KS1: 2B","KS1: 2C-","KS2: 6","KS2: 5+","KS2: 5-","KS2: 4","KS2: 3-","GCSE: 9","GCSE: 8","A_level: Maths + Further","A_level: Maths","A_level: No Maths"],"state":["KS1: 3+\nTotal students out = 210.\n\nAs % of KS1 stage.\n\tOut = 20.3%.","KS1: 2A\nTotal students out = 287.\n\nAs % of KS1 stage.\n\tOut = 27.8%.","KS1: 2B\nTotal students out = 282.\n\nAs % of KS1 stage.\n\tOut = 27.3%.","KS1: 2C-\nTotal students out = 254.\n\nAs % of KS1 stage.\n\tOut = 24.6%.","KS2: 6\nTotal students in = 27.\nTotal students out = 27.\nContinuation = 100%.\n\nAs % of KS2 stage.\n\tIn = 2.6%.\n\tOut = 2.6%.","KS2: 5+\nTotal students in = 134.\nTotal students out = 134.\nContinuation = 100%.\n\nAs % of KS2 stage.\n\tIn = 13%.\n\tOut = 13%.","KS2: 5-\nTotal students in = 234.\nTotal students out = 234.\nContinuation = 100%.\n\nAs % of KS2 stage.\n\tIn = 22.7%.\n\tOut = 22.7%.","KS2: 4\nTotal students in = 511.\nTotal students out = 511.\nContinuation = 100%.\n\nAs % of KS2 stage.\n\tIn = 49.5%.\n\tOut = 49.5%.","KS2: 3-\nTotal students in = 127.\nTotal students out = 127.\nContinuation = 100%.\n\nAs % of KS2 stage.\n\tIn = 12.3%.\n\tOut = 12.3%.","GCSE: 9\nTotal students in = 285.\nTotal students out = 285.\nContinuation = 100%.\n\nAs % of GCSE stage.\n\tIn = 27.6%.\n\tOut = 27.6%.","GCSE: 8\nTotal students in = 748.\nTotal students out = 748.\nContinuation = 100%.\n\nAs % of GCSE stage.\n\tIn = 72.4%.\n\tOut = 72.4%.","A_level: Maths + Further\nTotal students in = 25.\n\nAs % of A_level stage.\n\tIn = 2.4%.","A_level: Maths\nTotal students in = 89.\n\nAs % of A_level stage.\n\tIn = 8.6%.","A_level: No Maths\nTotal students in = 919.\n\nAs % of A_level stage.\n\tIn = 89%."]},"options":{"NodeID":"names","NodeGroup":"names","LinkGroup":null,"colourScale":"d3.scaleOrdinal(d3.schemeCategory20);","fontSize":7,"fontFamily":null,"nodeWidth":15,"nodePadding":10,"units":"","margin":{"top":null,"right":null,"bottom":null,"left":null},"iterations":0,"sinksRight":false}},"evals":[],"jsHooks":{"render":[{"code":"\n            function(el, x) {\n                d3.selectAll(\".node\").select(\"title foreignObject body pre\")\n                .text(function(d) { return d.state; });\n            }\n            ","data":null},{"code":"\n  function(el, x) {\n  d3.selectAll(\".link\").select(\"title foreignObject body pre\")\n  .text(function(d) { return d.name; });\n  }\n  ","data":null},{"code":"","data":null}]}}</script><div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Change the colour scheme where the links correspond to the node values (doesn't show in Rmarkdown)</span></span>
<span><span class="va">p</span> <span class="op">|&gt;</span> <span class="fu"><a href="../reference/add_column_names.html">update_sankey_colour</a></span><span class="op">(</span>colors_node <span class="op">=</span>  <span class="fu">viridis</span><span class="fu">::</span><span class="fu"><a href="https://sjmgarnier.github.io/viridisLite/reference/viridis.html" class="external-link">magma</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">p</span> <span class="op">|&gt;</span> <span class="fu"><a href="../reference/get_nodes.html">get_nodes</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>,</span>
<span>                          type <span class="op">=</span> <span class="st">'source'</span><span class="op">)</span> </span></code></pre></div>
<div class="sankeyNetwork html-widget html-fill-item" id="htmlwidget-d11fc4360aa0230696d7" style="width:700px;height:432.632880098888px;"></div>
<script type="application/json" data-for="htmlwidget-d11fc4360aa0230696d7">{"x":{"links":{"source":[0,1,2,3,0,1,2,3,0,1,2,3,0,1,2,3,0,1,2,3,4,5,6,7,8,4,5,6,7,8,9,10,9,10,9,10],"target":[4,4,4,4,5,5,5,5,6,6,6,6,7,7,7,7,8,8,8,8,9,9,9,9,9,10,10,10,10,10,11,11,12,12,13,13],"value":["4","2","11","10","20","44","43","27","45","70","58","61","114","134","132","131","27","37","38","25","7","31","64","149","34","20","103","170","362","93","7","18","25","64","253","666"],"name":["Flow: (KS1: 3+) -> (KS2: 6) = 4\n\n As percent of students leaving KS1: 3+ = 1.9%.\n\n As percent of students entering KS2: 6 = 14.8%.","Flow: (KS1: 2A) -> (KS2: 6) = 2\n\n As percent of students leaving KS1: 2A = 0.7%.\n\n As percent of students entering KS2: 6 = 7.4%.","Flow: (KS1: 2B) -> (KS2: 6) = 11\n\n As percent of students leaving KS1: 2B = 3.9%.\n\n As percent of students entering KS2: 6 = 40.7%.","Flow: (KS1: 2C-) -> (KS2: 6) = 10\n\n As percent of students leaving KS1: 2C- = 3.9%.\n\n As percent of students entering KS2: 6 = 37%.","Flow: (KS1: 3+) -> (KS2: 5+) = 20\n\n As percent of students leaving KS1: 3+ = 9.5%.\n\n As percent of students entering KS2: 5+ = 14.9%.","Flow: (KS1: 2A) -> (KS2: 5+) = 44\n\n As percent of students leaving KS1: 2A = 15.3%.\n\n As percent of students entering KS2: 5+ = 32.8%.","Flow: (KS1: 2B) -> (KS2: 5+) = 43\n\n As percent of students leaving KS1: 2B = 15.2%.\n\n As percent of students entering KS2: 5+ = 32.1%.","Flow: (KS1: 2C-) -> (KS2: 5+) = 27\n\n As percent of students leaving KS1: 2C- = 10.6%.\n\n As percent of students entering KS2: 5+ = 20.1%.","Flow: (KS1: 3+) -> (KS2: 5-) = 45\n\n As percent of students leaving KS1: 3+ = 21.4%.\n\n As percent of students entering KS2: 5- = 19.2%.","Flow: (KS1: 2A) -> (KS2: 5-) = 70\n\n As percent of students leaving KS1: 2A = 24.4%.\n\n As percent of students entering KS2: 5- = 29.9%.","Flow: (KS1: 2B) -> (KS2: 5-) = 58\n\n As percent of students leaving KS1: 2B = 20.6%.\n\n As percent of students entering KS2: 5- = 24.8%.","Flow: (KS1: 2C-) -> (KS2: 5-) = 61\n\n As percent of students leaving KS1: 2C- = 24%.\n\n As percent of students entering KS2: 5- = 26.1%.","Flow: (KS1: 3+) -> (KS2: 4) = 114\n\n As percent of students leaving KS1: 3+ = 54.3%.\n\n As percent of students entering KS2: 4 = 22.3%.","Flow: (KS1: 2A) -> (KS2: 4) = 134\n\n As percent of students leaving KS1: 2A = 46.7%.\n\n As percent of students entering KS2: 4 = 26.2%.","Flow: (KS1: 2B) -> (KS2: 4) = 132\n\n As percent of students leaving KS1: 2B = 46.8%.\n\n As percent of students entering KS2: 4 = 25.8%.","Flow: (KS1: 2C-) -> (KS2: 4) = 131\n\n As percent of students leaving KS1: 2C- = 51.6%.\n\n As percent of students entering KS2: 4 = 25.6%.","Flow: (KS1: 3+) -> (KS2: 3-) = 27\n\n As percent of students leaving KS1: 3+ = 12.9%.\n\n As percent of students entering KS2: 3- = 21.3%.","Flow: (KS1: 2A) -> (KS2: 3-) = 37\n\n As percent of students leaving KS1: 2A = 12.9%.\n\n As percent of students entering KS2: 3- = 29.1%.","Flow: (KS1: 2B) -> (KS2: 3-) = 38\n\n As percent of students leaving KS1: 2B = 13.5%.\n\n As percent of students entering KS2: 3- = 29.9%.","Flow: (KS1: 2C-) -> (KS2: 3-) = 25\n\n As percent of students leaving KS1: 2C- = 9.8%.\n\n As percent of students entering KS2: 3- = 19.7%.","Flow: (KS2: 6) -> (GCSE: 9) = 7\n\n As percent of students leaving KS2: 6 = 25.9%.\n\n As percent of students entering GCSE: 9 = 2.5%.","Flow: (KS2: 5+) -> (GCSE: 9) = 31\n\n As percent of students leaving KS2: 5+ = 23.1%.\n\n As percent of students entering GCSE: 9 = 10.9%.","Flow: (KS2: 5-) -> (GCSE: 9) = 64\n\n As percent of students leaving KS2: 5- = 27.4%.\n\n As percent of students entering GCSE: 9 = 22.5%.","Flow: (KS2: 4) -> (GCSE: 9) = 149\n\n As percent of students leaving KS2: 4 = 29.2%.\n\n As percent of students entering GCSE: 9 = 52.3%.","Flow: (KS2: 3-) -> (GCSE: 9) = 34\n\n As percent of students leaving KS2: 3- = 26.8%.\n\n As percent of students entering GCSE: 9 = 11.9%.","Flow: (KS2: 6) -> (GCSE: 8) = 20\n\n As percent of students leaving KS2: 6 = 74.1%.\n\n As percent of students entering GCSE: 8 = 2.7%.","Flow: (KS2: 5+) -> (GCSE: 8) = 103\n\n As percent of students leaving KS2: 5+ = 76.9%.\n\n As percent of students entering GCSE: 8 = 13.8%.","Flow: (KS2: 5-) -> (GCSE: 8) = 170\n\n As percent of students leaving KS2: 5- = 72.6%.\n\n As percent of students entering GCSE: 8 = 22.7%.","Flow: (KS2: 4) -> (GCSE: 8) = 362\n\n As percent of students leaving KS2: 4 = 70.8%.\n\n As percent of students entering GCSE: 8 = 48.4%.","Flow: (KS2: 3-) -> (GCSE: 8) = 93\n\n As percent of students leaving KS2: 3- = 73.2%.\n\n As percent of students entering GCSE: 8 = 12.4%.","Flow: (GCSE: 9) -> (A_level: Maths + Further) = 7\n\n As percent of students leaving GCSE: 9 = 2.5%.\n\n As percent of students entering A_level: Maths + Further = 28%.","Flow: (GCSE: 8) -> (A_level: Maths + Further) = 18\n\n As percent of students leaving GCSE: 8 = 2.4%.\n\n As percent of students entering A_level: Maths + Further = 72%.","Flow: (GCSE: 9) -> (A_level: Maths) = 25\n\n As percent of students leaving GCSE: 9 = 8.8%.\n\n As percent of students entering A_level: Maths = 28.1%.","Flow: (GCSE: 8) -> (A_level: Maths) = 64\n\n As percent of students leaving GCSE: 8 = 8.6%.\n\n As percent of students entering A_level: Maths = 71.9%.","Flow: (GCSE: 9) -> (A_level: No Maths) = 253\n\n As percent of students leaving GCSE: 9 = 88.8%.\n\n As percent of students entering A_level: No Maths = 27.5%.","Flow: (GCSE: 8) -> (A_level: No Maths) = 666\n\n As percent of students leaving GCSE: 8 = 89%.\n\n As percent of students entering A_level: No Maths = 72.5%."],"group":["link_1","link_2","link_3","link_4","link_5","link_6","link_7","link_8","link_9","link_10","link_11","link_12","link_13","link_14","link_15","link_16","link_17","link_18","link_19","link_20","link_21","link_22","link_23","link_24","link_25","link_26","link_27","link_28","link_29","link_30","link_31","link_32","link_33","link_34","link_35","link_36"],"colouring":["#000004FF","#0D0B2AFF","#281259FF","#491078FF","#000004FF","#0D0B2AFF","#281259FF","#491078FF","#000004FF","#0D0B2AFF","#281259FF","#491078FF","#000004FF","#0D0B2AFF","#281259FF","#491078FF","#000004FF","#0D0B2AFF","#281259FF","#491078FF","#671C80FF","#862781FF","#A6317DFF","#C63C74FF","#E34E65FF","#671C80FF","#862781FF","#A6317DFF","#C63C74FF","#E34E65FF","#F66C5CFF","#FC9065FF","#F66C5CFF","#FC9065FF","#F66C5CFF","#FC9065FF"]},"nodes":{"name":["KS1: 3+","KS1: 2A","KS1: 2B","KS1: 2C-","KS2: 6","KS2: 5+","KS2: 5-","KS2: 4","KS2: 3-","GCSE: 9","GCSE: 8","A_level: Maths + Further","A_level: Maths","A_level: No Maths"],"group":["node_1","node_2","node_3","node_4","node_5","node_6","node_7","node_8","node_9","node_10","node_11","node_12","node_13","node_14"],"state":["KS1: 3+\nTotal students out = 210.\n\nAs % of KS1 stage.\n\tOut = 20.3%.","KS1: 2A\nTotal students out = 287.\n\nAs % of KS1 stage.\n\tOut = 27.8%.","KS1: 2B\nTotal students out = 282.\n\nAs % of KS1 stage.\n\tOut = 27.3%.","KS1: 2C-\nTotal students out = 254.\n\nAs % of KS1 stage.\n\tOut = 24.6%.","KS2: 6\nTotal students in = 27.\nTotal students out = 27.\nContinuation = 100%.\n\nAs % of KS2 stage.\n\tIn = 2.6%.\n\tOut = 2.6%.","KS2: 5+\nTotal students in = 134.\nTotal students out = 134.\nContinuation = 100%.\n\nAs % of KS2 stage.\n\tIn = 13%.\n\tOut = 13%.","KS2: 5-\nTotal students in = 234.\nTotal students out = 234.\nContinuation = 100%.\n\nAs % of KS2 stage.\n\tIn = 22.7%.\n\tOut = 22.7%.","KS2: 4\nTotal students in = 511.\nTotal students out = 511.\nContinuation = 100%.\n\nAs % of KS2 stage.\n\tIn = 49.5%.\n\tOut = 49.5%.","KS2: 3-\nTotal students in = 127.\nTotal students out = 127.\nContinuation = 100%.\n\nAs % of KS2 stage.\n\tIn = 12.3%.\n\tOut = 12.3%.","GCSE: 9\nTotal students in = 285.\nTotal students out = 285.\nContinuation = 100%.\n\nAs % of GCSE stage.\n\tIn = 27.6%.\n\tOut = 27.6%.","GCSE: 8\nTotal students in = 748.\nTotal students out = 748.\nContinuation = 100%.\n\nAs % of GCSE stage.\n\tIn = 72.4%.\n\tOut = 72.4%.","A_level: Maths + Further\nTotal students in = 25.\n\nAs % of A_level stage.\n\tIn = 2.4%.","A_level: Maths\nTotal students in = 89.\n\nAs % of A_level stage.\n\tIn = 8.6%.","A_level: No Maths\nTotal students in = 919.\n\nAs % of A_level stage.\n\tIn = 89%."],"colouring":["#000004FF","#0D0B2AFF","#281259FF","#491078FF","#671C80FF","#862781FF","#A6317DFF","#C63C74FF","#E34E65FF","#F66C5CFF","#FC9065FF","#FEB67CFF","#FED99BFF","#FCFDBFFF"]},"options":{"NodeID":"names","NodeGroup":"names","LinkGroup":null,"colourScale":"d3.scaleOrdinal() .domain([ \"node_1\", \"node_2\", \"node_3\", \"node_4\", \"node_5\", \"node_6\", \"node_7\", \"node_8\", \"node_9\", \"node_10\", \"node_11\", \"node_12\", \"node_13\", \"node_14\", \"link_1\", \"link_2\", \"link_3\", \"link_4\", \"link_5\", \"link_6\", \"link_7\", \"link_8\", \"link_9\", \"link_10\", \"link_11\", \"link_12\", \"link_13\", \"link_14\", \"link_15\", \"link_16\", \"link_17\", \"link_18\", \"link_19\", \"link_20\", \"link_21\", \"link_22\", \"link_23\", \"link_24\", \"link_25\", \"link_26\", \"link_27\", \"link_28\", \"link_29\", \"link_30\", \"link_31\", \"link_32\", \"link_33\", \"link_34\", \"link_35\", \"link_36\" ]) .range([ \"#000004FF\", \"#0D0B2AFF\", \"#281259FF\", \"#491078FF\", \"#671C80FF\", \"#862781FF\", \"#A6317DFF\", \"#C63C74FF\", \"#E34E65FF\", \"#F66C5CFF\", \"#FC9065FF\", \"#FEB67CFF\", \"#FED99BFF\", \"#FCFDBFFF\", \"#000004FF\", \"#0D0B2AFF\", \"#281259FF\", \"#491078FF\", \"#000004FF\", \"#0D0B2AFF\", \"#281259FF\", \"#491078FF\", \"#000004FF\", \"#0D0B2AFF\", \"#281259FF\", \"#491078FF\", \"#000004FF\", \"#0D0B2AFF\", \"#281259FF\", \"#491078FF\", \"#000004FF\", \"#0D0B2AFF\", \"#281259FF\", \"#491078FF\", \"#671C80FF\", \"#862781FF\", \"#A6317DFF\", \"#C63C74FF\", \"#E34E65FF\", \"#671C80FF\", \"#862781FF\", \"#A6317DFF\", \"#C63C74FF\", \"#E34E65FF\", \"#F66C5CFF\", \"#FC9065FF\", \"#F66C5CFF\", \"#FC9065FF\", \"#F66C5CFF\", \"#FC9065FF\" ])","fontSize":7,"fontFamily":null,"nodeWidth":15,"nodePadding":10,"units":"","margin":{"top":null,"right":null,"bottom":null,"left":null},"iterations":0,"sinksRight":false}},"evals":[],"jsHooks":{"render":[{"code":"\n            function(el, x) {\n                d3.selectAll(\".node\").select(\"title foreignObject body pre\")\n                .text(function(d) { return d.state; });\n            }\n            ","data":null},{"code":"\n  function(el, x) {\n  d3.selectAll(\".link\").select(\"title foreignObject body pre\")\n  .text(function(d) { return d.name; });\n  }\n  ","data":null},{"code":"","data":null}]}}</script><div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span></span>
<span><span class="co"># Change the colour for only specified links. (doesn't show in Rmarkdown)</span></span>
<span><span class="va">col</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">'gray'</span>, <span class="va">p</span> <span class="op">|&gt;</span> <span class="fu"><a href="../reference/get_nodes.html">get_links</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">col</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">5</span>,<span class="fl">10</span><span class="op">)</span><span class="op">]</span> <span class="op">=</span> <span class="st">'orange'</span></span>
<span><span class="va">col</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">25</span>,<span class="fl">20</span><span class="op">)</span><span class="op">]</span> <span class="op">=</span> <span class="st">'green'</span>  </span>
<span></span>
<span><span class="va">q</span> <span class="op">=</span> <span class="va">p</span> <span class="op">|&gt;</span> <span class="fu"><a href="../reference/add_column_names.html">update_sankey_colour</a></span><span class="op">(</span>colors_node <span class="op">=</span> <span class="fu">viridis</span><span class="fu">::</span><span class="fu"><a href="https://sjmgarnier.github.io/viridisLite/reference/viridis.html" class="external-link">magma</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">p</span> <span class="op">|&gt;</span> <span class="fu"><a href="../reference/get_nodes.html">get_nodes</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>,</span>
<span>                                colors_link <span class="op">=</span> <span class="va">col</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="saving-exporting-sankey-diagrams">Saving / exporting sankey diagrams<a class="anchor" aria-label="anchor" href="#saving-exporting-sankey-diagrams"></a>
</h3>
<p>We can use the <code>saveNetwork()</code> from the NetworkD3 package
to save the widget into an .html file or we can use the webshot()
function from the webshot2 package to save a static version of the plot
to a .png file (by taking an image from a saved .html version.</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Save the interactive sankey diagram</span></span>
<span><span class="fu">networkD3</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/networkD3/man/saveNetwork.html" class="external-link">saveNetwork</a></span><span class="op">(</span>network <span class="op">=</span> <span class="va">p</span>,</span>
<span>                       file <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">'sankey_diagram.html'</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Save a static version of the plot (need to save an interactive version first)</span></span>
<span><span class="fu">webshot2</span><span class="fu">::</span><span class="fu">webshot</span><span class="op">(</span>url <span class="op">=</span> <span class="st">'sankey_diagram.html'</span>,</span>
<span>                  file <span class="op">=</span>  <span class="st">'sankey_diagram.png'</span>,</span>
<span>                  vwidth <span class="op">=</span> <span class="fl">1000</span>,</span>
<span>                  vheight <span class="op">=</span> <span class="fl">700</span><span class="op">)</span></span></code></pre></div>
<p>Or to save the underlying information in the sankey diagram to
formatted .xlsx file you can use the function
<code><a href="../reference/sankey_export_xlsx.html">sankey_export_xlsx()</a></code>, which allows a title and source to be
added to the spreadsheet (needed for statistical disclosure). This
method creates a spreadsheet with the columns ‘Source’, ‘Target’ and
‘Number of Students’ describing the flow between all nodes in the
diagram. If we are saving a filtered sankey diagram another column will
be added informing whether the flow relates to the traced or non-traced
students.</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="co"># Save an .xlsx file containing the sankey information (for SDC check)</span></span>
<span>  <span class="va">p</span> <span class="op">|&gt;</span> <span class="fu">LStools</span><span class="fu">::</span><span class="fu"><a href="../reference/sankey_export_xlsx.html">sankey_export_xlsx</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">'Student flow from KS1 to A-level choices'</span>,</span>
<span>                              source <span class="op">=</span> <span class="st">'Source: National Pupil Database'</span>,</span>
<span>                              filepath <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/getwd.html" class="external-link">getwd</a></span><span class="op">(</span><span class="op">)</span>, <span class="st">'/sankey_information.xlsx'</span><span class="op">)</span><span class="op">)</span></span>
<span>  </span>
<span>    <span class="co"># Save an .xlsx file containing the sankey information traced version</span></span>
<span>    <span class="va">p</span> <span class="op">=</span> <span class="fu"><a href="../reference/sankey_trace.html">sankey_trace</a></span><span class="op">(</span>pathways <span class="op">=</span> <span class="va">pathways</span>,</span>
<span>                     flow_columns <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span><span class="op">:</span><span class="fl">5</span><span class="op">)</span>,</span>
<span>                     split_by <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'GCSE: 9'</span>,<span class="st">'GCSE: 8'</span> <span class="op">)</span>,</span>
<span>                     union <span class="op">=</span> <span class="cn">T</span><span class="op">)</span> </span>
<span>    <span class="va">p</span> <span class="op">|&gt;</span></span>
<span>      <span class="fu">LStools</span><span class="fu">::</span><span class="fu"><a href="../reference/sankey_export_xlsx.html">sankey_export_xlsx</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">'Student flow from KS1 to A-level choices tracing those that achieve grade 8 or 9 at GCSE'</span>,</span>
<span>                              source <span class="op">=</span> <span class="st">'Source: National Pupil Database'</span>,</span>
<span>                              filepath <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/getwd.html" class="external-link">getwd</a></span><span class="op">(</span><span class="op">)</span>, <span class="st">'/sankey_information2.xlsx'</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>You can recreate the sankey diagrams (or return a list of nodes and
links required for sankey diagrams) from the exported .xlsx files by
using the <code><a href="../reference/sankey_from_extract.html">sankey_from_extract()</a></code> ( or
<code><a href="../reference/links_from_extract.html">links_from_extract()</a></code>).</p>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Jake Powell.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.9.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
